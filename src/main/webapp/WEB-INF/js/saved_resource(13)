M.add("www-countdown",function(a){var b=a.mt.www,c=function(){function a(a){a=parseInt(a/1e3,10);for(var b,d,e=c.slice(0),f=[];d=e.pop();)b=a%d,a-=b,a/=d,f.unshift(b);return f.unshift(a),f}function b(b,c){function d(){}this.time=a(b),c=c||{},this.start=c.start||d,this.step=c.step||d,this.done=c.done||d}var c=[0,24,60,60],d=function(a){var b=this;arguments.length||(a=b.time);for(var e=a.length;0===a[--e];);if(-1===e)return b.done(),b.stop();var f=a.pop();--f<0&&(f=c[a.length]-1,d.call(b,a)),b.step(f,a.length),a.push(f),arguments.length||(b.time=a)};return b.prototype.tick=function(){function a(){d.call(b)}var b=this;return b.start(),b.tick.handler=setInterval(a,1e3),b},b.prototype.stop=function(){try{clearInterval(this.tick.handler)}catch(a){}return this},b.prototype.reset=function(b){this.time=a(b),this.stop(),this.tick()},b}();b.Countdown=c},"1.0.0",{requires:["www-base"]});
M.add("www-deal-dynamiccomponent",function(a){function b(a){z&&(q(),z.delegate("click",function(a){var b=this.ancestor().ancestor();b&&(b.hasClass("deal-component-inline-text-folded")?a.target.setHTML("收起"):a.target.setHTML("显示全部"),b.toggleClass("deal-component-inline-text-folded"))},a))}function c(){var a=".J-toggle-more-schemes";z.delegate("click",function(){var a="deal-component-hide-other-scheme-patch",b=this.ancestor(),c=this.one("span");if(c){var d=c.getHTML();c.setHTML(c.getData("alternativeText")),c.setData("alternativeText",d)}b.toggleClass(a)},a)}function d(){function b(){return d?parseInt(d.get("value"),10)||1:1}function c(a){d&&d.set("value",a)}var d=a.one(".J-cart-quantity");return{get:b,set:c}}function e(){var b=a.one(".deal-component-remaining-time-text");if(!b)return void f();var c=parseInt(b.getData("remaining-time"),10)-Date.now();return c>=6048e5?void f():(b.removeClass("hidden"),I?void I.reset(c):(I=new y(c,{start:function(){var a=this,c=b.all(".J-slot");a.ndSlots=c,c&&c.each(function(b,c){b&&b.setHTML(a.time[c])})},step:function(a,b){try{this.ndSlots.item(b).setHTML(a)}catch(c){}}}),void I.tick()))}function f(){var b=a.one(".last-buyer-text");b&&b.removeClass("hidden")}function g(b){function c(a){var b=e.getData("max")-0;if(isNaN(a))return f.setHTML("请输入正确的购买数量"),!0;if(f.getHTML().length&&f.setHTML(""),z.one(".J-type-select")&&z.one(".J-type-selected")){var c=z.one(".J-type-selected").getData("dealgoodsrest");if(a>c&&b>c)return f.setHTML("还剩 "+c+"单"),!0}return 1>a?(f.setHTML("最少 1 件起售"),0===a&&setTimeout(function(){f.setHTML("")},3e3),!0):a>b?(f.setHTML("每人最多只能购买 "+b+"单"),a===b+1&&setTimeout(function(){f.setHTML("")},3e3),!0):(f.getHTML().length&&f.setHTML(""),!1)}function d(b){var c=z.one(".J-hotel-uni-info"),d=z.one(".J-hotel-cart-quantity");if(!c&&d.getData("basenum")){var e=d.getData("basenum");return void d.set("value",e*b)}var f=c.getData("countinfo");if(f){var g=a.JSON.parse(c.getData("countinfo")),h="",i="";for(i in g)g.hasOwnProperty(i)&&(g[i]*=b,h=h+i+"-"+g[i]+",");d&&d.set("value",g[i]),c.set("value",h.slice(0,-1))}}if(z){var e=z.one(".J-cart-quantity"),f=z.one(".deal-component-quantity-warning");z.delegate("click",function(a){var b=a.target,f=e.get("value")-0,g=f;c(g)||(g="-"===b.getData("action")?f-1:f+1,c(g)||(e.set("value",g),z.one(".J-hotel-cart-quantity")&&d(g)))},"button"),e&&(e.on("blur",function(){var a=e.get("value")-0;c(a)}),e.on("focus",function(){setTimeout(function(){e.select()},50)}))}}function h(b){var c=".J-component-share-tip-dialog";a.use("w-simpledialog",function(a){function d(){e&&(e._dialog._isHidden()?e.open():e.close())}if(z){var e=void 0;z.delegate("click",function(){e||(e=new a.mt.widget.SimpleDialog({id:"deal-component-share-dialog",node:a.one(c),width:118,content:b,location:"bl"})),d()},c)}})}function i(b){function c(b){a.use("mt-dialog",function(a){f=new a.mt.Dialog({id:"qq-dialog",width:"500px",title:"分享给QQ好友",content:'<div>通过QQ、电子邮件发送链接给你的朋友</div><input type="text" class="deal-share-qq-input" value="'+b+'" maxlength="40"><input class="deal-share-qq-copy" type="button" value="复制" class="btn btn-mini" style="display:none">'}),w.selectAndCopy(".deal-share-qq-input",".deal-share-qq-copy")})}function d(){f&&("open"===f._status?f.close():f.open())}function e(a){v("/deal/inviteurl/"+b+"/"+a,{method:"GET",on:{success:function(a,b){var d=x.getEvalRes(b);d.status&&c(d.data)},failure:function(){},end:d}})}var f=void 0;a.one("body").delegate("click",function(a){if(f)d();else{var c=a.target.getData("userid")||"";e(b,c)}},".deal-share-im")}function j(b){var c,d,e,f,g,h,i=!1;b.delegate("click",function(){var c=this.getData("priceId");h=this.ancestor(".J-price-selection-container"),d=b.all(".J-price-selection"),e=b.one(".J-price-id-input"),g=b.one(".J-hotel-uni-info"),f=b.one(".J-cart-quantity");var i=f.get("value");d.each(function(a){var b=a.one("i");a.removeClass("deal-detail-selection-item--current"),b&&a.removeChild(b)}),this.appendChild("<i></i>"),this.addClass("deal-detail-selection-item--current"),h.one(".price-selection").removeClass("price-selection--confirm"),e.setAttribute("value",c),g.setAttribute("value",c+"-"+i),g.setAttribute("data-countinfo",'{"'+c+'":"1"}'),E=d.indexOf(this),a.one(".J-buy-price")&&a.one(".J-buy-price").setHTML("<strong>"+this.getData("price")+"</strong>")},".J-price-selection"),b.delegate("click",function(e){return d=b.all(".J-price-selection"),c=b.one(".price-selection-container"),b.one(".deal-component-quantity-warning")&&""!==b.one(".deal-component-quantity-warning").get("innerHTML")?void e.halt():b.one(".deal-select-incomplete")?(e.halt(),void w.Sku.initNeedSelect(e,a.one(".deal-component-container"),"J-mini-cart-buy")):(d.each(function(a){a.hasClass("deal-detail-selection-item--current")&&(i=!0)}),void(c&&!i&&(e.halt(),c&&(c.one(".price-selection").addClass("price-selection--confirm"),D=!0))))},".J-mini-cart-buy")}function k(a){var b=!1;a.delegate("click",function(){var c=a.all(".uniprice-hide-tr");b?(c.removeClass("uniprice-show"),this.setHTML('全部<i class="arrow-up"></i>'),b=!1):(c.addClass("uniprice-show"),this.setHTML('收起<i class="arrow-down"></i>'),b=!0)},".uniprice-toggle")}function l(b){b&&b.one(".J-multi-appoint-buy-button")&&(b.delegate("click",function(a){var c=(b.one(".J-select-input"),b.one(".deal-component-purchase-button")),d=b.one(".J-hotel-multiappoint"),e=b.one(".J-multi-appoint-buy-button"),f=e.one("input"),g=(e.one("a"),b.one(".J-selected-poiid"));""===g.get("value")?(a.halt(),d.addClass("hotel-multiappoint"),e.show(),c.hide(),f.hide()):b.one("form").submit()},".J-mini-cart-buy"),b.delegate("click",function(){b.one(".J-hotel-multiappoint").removeClass("hotel-multiappoint"),b.one(".J-multi-appoint-buy-button").hide(),b.one(".deal-component-purchase-button").show()},".J-close"),b.delegate("click",function(a){a.currentTarget.hasClass("multi-appoint-buy")?b.one("form").submit():b.one(".J-mini-cart-buy").simulate("click")},".multi-appoint-buy, .J-multi-appoint-buy-button"),a.on("storeSelector:done",function(a){var c=(b.one(".J-select-input"),b.one(".J-multi-appoint-buy-button")),d=c.one("input"),e=c.one("a"),f=b.one(".J-selected-poiid");""!==f.get("value")&&(d.show(),e.hide())}))}function m(b){var c=b.one(".deal-component-campaigns-egregious-deal");if(c){var d=b.one(".J-egregious-deal-popover-countdown");if(d){var e=d.getData("duration");if(e){var f=d.getData("more-than-a-day");if(e=a.JSON.parse(e),e.now&&e.begin&&e.end&&!(e.now>e.end)){var g,h=c.hasClass("available-for-purchase");g=e.now<e.begin?e.begin-e.now:e.end-e.now,g=1e3*g;var i=d.all("span");G?G.reset(g):(G=new y(g,{start:function(){a.each(this.time,function(a,b){b&&(a=("0"+a).slice(-2),f||b--,i.item(b).setHTML(a))})},step:function(a,b){b&&(a=("0"+a).slice(-2),f||b--,i.item(b).setHTML(a))},done:function(){h&&location.reload()}}),G.tick()),c.removeClass("hidden")}}}}}function n(){var a=z.one(".deal-component-rating-sold-count");a&&a.removeClass("hidden")}function o(){var a=z.one(".deal-component-rating-stars");a&&a.removeClass("hidden")}function p(){var a=z.one(".deal-component-rating-comment-count");a&&a.removeClass("hidden")}function q(){var a=z.one(".J-toggle-inline");if(a){var b=a.previous();return b&&b.getDOMNode().scrollWidth!==b.getDOMNode().clientWidth?void 0:void a.remove()}}function r(e,f){if(e&&J){b(".J-toggle-inline"),F=f.slug;var g=a.one("#J-share-link-list").getHTML();M.load(function(){h(g)}),i(F),c(),H.init(),A=d(),B=A.get(),C=e.one(".J-hotel-cart-quantity")?".J-hotel-cart-quantity":".J-cart-quantity",E=-1,D=!1,l(e),j(e),k(e)}}function s(a,b){var c="referrer"in document?document.referrer:window.location.href;if(b.noupdate)return null;if(b.isUnavailable)return n(),o(),p(),null;var d=t(window.location.search),e={act:a,args:b.id,__referer:c};return d.ci&&d.co&&(e.ci=d.ci,e.co=d.co),d.cityid&&(e.cityid=d.cityid),d.poiid&&(e.poiid=d.poiid),e}function t(a){var b,c={},d=a.slice(1),e=d.split("&"),f=e.length;for(b=0;f>b;b++){var g=e[b].split("=")[0]+"",h=e[b].split("=")[1];c[g]=h}return c}function u(b,c,d){b.setHTML(c),d&&d.isMobileOnly&&a.mt.www.Deal.initMobileOnlyDialog(),n(),o(),p(),e(),m(z),A.set(B),w.Sku.initTypeSelection(z),w.Sku.initRemindClose(z),w.Sku.initTypeSelectAll(z),g(".deal-component-quantity"),w.AddCart.init(".J-add-mini-cart",C),a.mt.widget.init();var f=z.one(".J-fav-count");f&&f.removeClass("hidden"),J.addFavorite(F,"J-component-add-favorite");var h=z.one("form");if(h){a.use("www-tracker",function(a){a.mt.www.tracker.appendFormTrackingFields(h)});var i=a.one(".J-price-selection-container");if(i&&(i.removeClass("hidden"),D&&i.one(".price-selection").addClass("price-selection--confirm"),E>=0)){var j=i.all(".J-price-selection").item(E);j.addClass("deal-detail-selection-item--current"),j.appendChild("<i></i>")}}a.one(".uix-tooltip-tip")&&a.one(".uix-tooltip-tip").remove(!0),q()}var v=a.io,w=a.mt.www,x=a.mt.util,y=w.Countdown,z=a.one(".J-deal-component-info");a.namespace("mt.www.DealDynamiccomponent");var A,B,C,D,E,F,G,H=function(){function b(a){function b(a){var b=null;if(null===e&&(e=d.one("img")),a.currentTarget.hasClass("ui-slider__control--right")?(b=e.next("img"),null===b&&(b=d.one("img"))):a.currentTarget.hasClass("ui-slider__control--left")&&(b=e.previous("img"),null===b&&(b=d.all("img").slice(-1).item(0))),null!==b&&b!==e){e.removeClass("active"),b.addClass("active"),e=b;var f=b.getData("large-src");f&&f!==c.get("large-src")&&c.set("src",f)}}if(a){var c=a.one(".focus-view");if(c){c.onload&&(c.onload=null);var d=a.one(".candidates");if(d){d.removeClass("hidden");var e=d.one(".active"),f=a.all(".ui-slider__control");d.all("img").size()<2?f.each(function(a){a.remove()}):f.each(function(a){a.on("click",b)}),d.on("mouseover",function(a){var b=a.target;if(b&&"img"===b.get("tagName").toLowerCase()&&(!e||e!==b)){e.removeClass&&e.removeClass("active"),b.addClass("active"),e=b;var d=b.getData("large-src");d&&d!==c.get("large-src")&&c.set("src",d)}})}}}}var c=a.all(".simple-gallery");if(c)return{init:function(){c.each(b)}}}(),I=null,J=a.mt.www.Deal;w.DealDynamiccomponent={init:r,beforeupdate:s,update:u}},"0.0.1",{requires:["www-deal","www-add-cart","www-sku","www-countdown"]});
M.add("www-deal-map",function(a){var b=a.io,c=a.DOM,d=a.Lang.trim,e=a.mt.util,f=a.mt.www;f.DealMap={COUNT_PER:3,scoreRankCache:{},BizsPoiInfo:{update:function(b,c){var d=a.one(".address-list"),e=a.one(".loading-image");e&&e.hide(),d&&d.show();var g=a.JSON.parse(c);if(b&&g){var h=a.JSON.parse(b.getData("bizsConfig")),i=h.dealId,j=h.cityId,k=h.geoList;f.DealMap.initBizsPoi(i,j,k,h,g)}}},initBizsPoi:function(b,c,d,e,f){function g(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(b=b.concat(a[c]));return b}var h=this,i={},j=a.one(".J-biz-wrapper"),k=a.one("#J-bizinfo-list");k&&(e=e||{},i[c]=f[c]||g(f),k.setData("poiList",i),k.setData("actionUrl","/deal/poilist/"+b),k.on("poiChange",function(){h.updateBizMapPOI(k)}),this.initBizInfo(k,i[c],e),f&&(e.geoInMultiCity||f.length>3)&&h.initPOIFilter(k,d,c,e),j.addClass("inited"))},initPOIFilter:function(b,d,e,f){function g(a,b,c){var d="";return c=c||0,d+='<select class="biz-filter dropdown--small">',d+=h(a,b,c),d+="</select>"}function h(a,b,c){var d,e="";c=+c,b&&(e='<option value="0">'+l[b]+"</option>");for(d in a)a.hasOwnProperty(d)&&"0"!==d.toString()&&(e+="<option "+(+a[d].id===c?' selected="selected"':"")+'value="'+a[d].id+'">'+a[d].name+"</option>");return e}function i(){var e,g,i,k,l,n,o,p,q=a.one(".J-filter-wrapper"),r=0;j=q.all("select"),j.each(function(a){r++,a.setData("index",r)}),j.each(function(a){a.on("change",function(){function a(a,c){var d=[];d.push(b),d.push(a),d.push(c),d.push(i),2===e&&d.push(l),3===e&&(d.push(l),d.push(p)),m.getPOIMapDataByFilter.apply(m,d)}e=this.getData("index"),i=j.item(0).get("value"),g=d[i]||{},n=j.item(1),o=j.item(2),l=+n.get("value"),k=g.district[l]||{},p=+j.item(2).get("value"),(1===e||2===e)&&(1===e&&(l=0,n.getDOMNode().options.length=0,n.appendChild(c.create(h(g.district,"dis",l)))),p=0,o.getDOMNode().options.length=0,o.appendChild(c.create(h(k.range,"range",p)))),a("bizData",function(a){m.initBizInfo(b,a,f),b.fire("poiChange")})})})}var j,k,l={dis:"全部城区",all:"全国",range:"全部商圈"},m=this;k='<div class="J-filter-wrapper biz-filter-wrapper">',k+='<span class="biz-filter-title">位置筛选:</span>',d[e]?(k+=g(d,"0"===e.toString()?"all":"",e),k+=g(d[e].district,"dis",0),k+=g([],"range",0)):(k+=g(d,"all",e),k+=g([],"dis",0),k+=g([],"range",0)),k+="</div>",b.insert(c.create(k),"before"),i()},initMapData:function(b){var c,d=a.one("#J-bizinfo-list"),e=this;d&&(c=d.getData("toShowMapList"),c&&(b.shops=c),d.setData("mapData",b),a.use("soso-map",function(a){e.toggleMapLoadingMask(!1),a.mt.www.Map.showBizMap(b,!0)}))},getPOIMapDataByFilter:function(c,d,f,g,h,i){function j(){return s?void k():void b(t,{method:"GET",on:{success:function(b,c){var d=e.getEvalRes(c);a.mix(r,d),s=r[g]||a.Object.values(r).shift(),k()},failure:function(){}}})}function k(){"0"===g.toString()?l():i&&0!==i?l("rangeid",i):h&&0!==h?l("disid",h):0===i?l("disid",h):l(),"mapData"===d?(o=c.getData("mapData"),o.shops=v,f(o)):"bizData"===d&&f(u),u=null,v=null}function l(a,b){"mapData"===d?m(a,b):n(a,b)}function m(a,b){for(p=0;p<s.length;p++)q=s[p],q&&(a?q[a].toString()===b.toString()&&(q.position=e.decodeJSON(q.latlng),v[q.shopid]=q):(q.position=e.decodeJSON(q.latlng),v[q.shopid]=q))}function n(a,b){if(a)for(p=0;p<s.length;p++)q=s[p],q&&q[a].toString()===b.toString()&&u.push(q);else u=u.concat(s)}var o,p,q,r=c.getData("poiList"),s=r[g],t=c.getData("actionUrl"),u=[],v={};j()},toggleMapLoadingMask:function(b){var c=a.one("#J-map-loading");c&&(b?c.show():c.hide())},updateBizMapPOI:function(b){var c=b.getData("mapData"),d=this;c&&(this.toggleMapLoadingMask(!0),c.shops=b.getData("toShowMapList"),window.setTimeout(function(){a.Global.fire("dealMapMarkers:change",c,function(){d.toggleMapLoadingMask(!1)})},50))},initBizInfo:function(a,b,c){var d;a&&b&&(d=a.ancestor(".biz-wrapper"),this.renderPOIList(a,b,1,c),this.initBizPageNav(a,b,c),!d.one(".J-bizs-link")&&b.length<=this.COUNT_PER?d.addClass("biz-wrapper-nobottom"):d.removeClass("biz-wrapper-nobottom"))},initBizPageNav:function(b,d,e){var f,g,h=this;b&&(f=b.ancestor().one(".paginator"),f&&f.remove(!0),d.length<=this.COUNT_PER||(f=b.ancestor().appendChild(c.create('<div class="paginator"></div>')),a.use("www-pagenav",function(){var c=Math.ceil(d.length/h.COUNT_PER),i={currentPage:1,maxPage:c,showNavCount:3,hasHeadEnd:!1};g=new a.mt.www.PageNav(f,function(a){h.renderPOIList(b,d,a.index,e),b.fire("poiChange"),i.currentPage=a.index,g.render(i)}),g.render(i)})))},renderPOIList:function(c,d,f,g){var h,i="",j="",k={},l=[],m=d.length,n=this;g=a.merge(g),g.reservationPhoneNumber=c.getData("reservationPhoneNumber")||"",g.noReservationPhone=c.getData("noReservationPhone"),f=(f-1)*this.COUNT_PER;for(var o=f;o<f+this.COUNT_PER&&m>o;o++)h=d[o],h.position=e.decodeJSON(h.latlng),i+=this.renderPOIItem(h,g,o===f,1===m),k[h.shopid]=h,n.scoreRankCache[h.poiid]||l.push(h.poiid);l.length&&(j="/deal/poicompare/"+l.join(","),b(j,{method:"get",on:{success:function(b,c){var d=e.getEvalRes(c);if(d)for(var f=null,g="",h=null,i=0,j=d.length;j>i;i++)h=d[i],g=h.poiid,n.scoreRankCache[g]=h,f=a.one("#biz-scorerank"+g),f&&f.setHTML(n.fillScoreRank(h))}}})),c.setData("toShowMapList",k),c.setHTML(i),this.initMapData(a.JSON.parse(c.getData("mapConfig"))),a.mt.widget.init(c),a.Global.fire("PageHeight:change")},renderPOIItem:function(b,c,f,g){function h(a,b,c){for(var d,e=/[^a-zA-Z\s]/,f=c;f<a.length;f++)if(e.test(a.charAt(f)))return d=a.split(""),d.splice(f,b,"..."),d.join("");return""}function i(a){var b=a.replace(/[^\u4e00-\u9fa5\uFE30-\uFFA0\s]/g,"").length;return parseInt((a.length-b)/2+b,10)}function j(a){return 2===a.length&&a[0]&&a[1]&&a[0]-3.8>1e-7&&53.5-a[0]>1e-7&&a[1]-73.6>1e-7&&135-a[1]>1e-7?!0:!1}function k(a){a.length>t&&(q=i(a)-t,q>0&&(a=h(a,q,5))),s.bizName=a}function l(a){if(a){var c,d=a.fbcount||0;c=d>0?'<span class="biz-info__text"><span class="biz-info__rate-count">'+d+"人评价</span></span>":'<span class="biz-info__text">暂无评价</span>',s.bizRates='<div class="biz-item">评价：<a title="商家历史团购累积评分" gaevent="content/detail/poirank" class="biz-info__link" target="_blank" href="/shop/'+b.poiid+'#evaluate-box">'+c+"</a></div>"}}function m(a,b){if(!a||a.fbcount<1)s.bizScoreRank="";else{var c="",d=u.scoreRankCache[b];d&&(c=u.fillScoreRank(d)),s.bizScoreRank='<div id="biz-scorerank'+b+'">'+c+"</div>"}}var n,o,p,q,r=a.one("#deal-poilist-markup"),s={currentBiz:"",poiLink:"",bizName:"",fullBizName:"",bizAddress:"",title:"",searchPath:"",bizLevel:"",bizScoreRank:"",subway:"",phone:"",hotelAppointmentInfo:"",reservationPhoneNumber:""},t=15,u=this;if(f&&(s.currentBiz=" biz-info--open biz-info--first"),g&&(s.currentBiz+=" biz-info--only"),s=s||{},p=b.name,c.isPOIMultiCity&&b.cityname&&(p+="("+b.cityname+")"),!c.hidephone&&b.phone)if(s.phone='<div class="biz-item" data-uix="tooltip" data-params="{showEvent: \'click\'}"></div>',c.reservationPhoneNumber){var v="预约电话： ";"1"===c.noReservationPhone&&(v="电话： "),s.phone+='<div class="biz-item"><span class="title-label">'+v+"</span>"+c.reservationPhoneNumber+"</div>"}else s.phone+='<div class="biz-item"><span class="title-label">电话：</span>'+b.phone+"</div>";return s.fullBizName=p,k(p),l(b.poilevel),m(b.poilevel,b.poiid),b.poiid&&(s.poiLink="http://"+(b.cityfirstalpha?b.cityfirstalpha:"www")+"."+M.DOMAIN_HOST+"/shop/"+b.poiid),b.subwayname&&(n=d(b.subwayname),n.lastIndexOf("站")===n.length-1&&(n=n.substring(0,n.lastIndexOf("站"))),s.subway='<div class="subway-distance biz-item"><span class="title-label">地铁：</span>距'+n+"站约"+b.subwaydis+"米</div>"),b.latlng&&(o=e.decodeJSON(b.latlng),j(o)&&(s.searchPath='<div class="biz-item link-item"><a class="view-map" href="javascript:void(0)" data-id="'+b.shopid+'" data-poiid="'+b.poiid+'"'+a.mt.www.getMTEventAttr({shopid:b.shopid,poiid:b.poiid,la:"deal/viewmap"})+' gaevent="content/detail/map/detail">查看地图</a><a class="search-path" href="javascript:void(0)" data-id="'+b.shopid+'" gaevent="content/detail/map/drive">公交/驾车去这里</a></div>')),a.mix(s,{bizAddress:b.address,title:b.address},!0),a.Lang.sub(r.getHTML(),s)},fillScoreRank:function(b){var c="",d={title:"",scoreShort:"",score:"",rank:"",rankPercentage:"",rankClass:"",arrowText:""},e=b.ranklist,f='<div class="biz-item scorerank-item"><span class="title-label" style="visibility: hidden;">{title}：</span><span class="scorerank-item__score" title="{score}">{scoreShort}分</span><span class="scorerank-item__rank {rankClass}"><span class="scorerank-item__text">{rank}<span class="scorerank-item__percentage">{rankPercentage}</span></span><i class="arrow">{arrowText}</i></span></div>';c="";for(var g=0,h=e.length;h>g;g++){var i=e[g];"0.0"!==Number(i.score).toFixed(1)&&(d.title=i.title,d.score=i.score,d.scoreShort=Number(i.score).toFixed(1),i.scorerank>0?(d.rankClass="rank-up",d.rank="高于同行业",d.arrowText="",d.rankPercentage=Number(i.scorerank).toFixed(1)+"%"):i.scorerank<0?(d.rankClass="rank-down",d.rank="低于同行业",d.arrowText="",d.rankPercentage=Math.abs(i.scorerank).toFixed(1)+"%"):(d.rankClass="rank-normal",d.rank="与同行业持平",d.arrowText="--",d.rankPercentage=""),c+=a.Lang.sub(f,d))}return c}}},"1.0.0",{requires:["www-base"]});