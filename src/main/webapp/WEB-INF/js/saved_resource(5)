M.add("mt-formchecker",function(a){function b(){b.superclass.constructor.apply(this,arguments)}var c=a.Node,d=a.io,e=a.Object,f=a.Lang.isFunction,g=a.Lang.isString,h=a.Lang.trim,i=a.mt.util,j={old:{fieldGroup:"field-group",highlightGroup:"field-group--highlight",type:"field-group--type",ok:"field-group--ok",error:"field-group--error"},"new":{fieldGroup:"form-field",highlightGroup:"form-field--highlight",type:"form-field--type",ok:"form-field--ok",error:"form-field--error"}},k=".",l="FormChecker: ",m=200,n="success",o="failure";b.NAME="formChecker",b.STATUS_INIT=0,b.STATUS_CHECKING=1,b.STATUS_OK=2,b.STATUS_ERROR=3,b.CLASS_INLINE_TIP="inline-tip",b.CLASS_BLOCK_TIP="block-tip",b.CHECK_EMPTY_FN=function(a){return""===h(a.get("value"))},b.ATTRS={form:{value:null,setter:"_setForm",writeOnce:!0},fields:{value:null},checkEvent:{value:"submit",writeOnce:!0},tipClass:{value:b.CLASS_INLINE_TIP,writeOnce:!0},showOkTip:{value:!1,writeOnce:!0},highlightGroup:{value:!1,writeOnce:!0},async:{value:!1,writeOnce:!0},newStyle:{value:!1,writeOnce:!0}};var p={initializer:function(){var a,b=this,c=b.get("form"),d=b.get("fields"),e=b.get("async"),f=b.get("newStyle");if(!c)throw new Error(l+"必须设置form参数");if(!d)throw new Error(l+"必须设置fields参数");b.className=f?j["new"]:c.one(k+j.old.fieldGroup)?j.old:j["new"],b.publish(n,{emitFacade:!0,defaultFn:b._defSuccessFn}),b.publish(o,{emitFacade:!0,defaultFn:b._defFailureFn}),a={emitFacade:!0},e&&(a.defaultFn=function(){c.submit()}),b.publish("submitSuccess",a),b.publish("submitFailure",{emitFacade:!0}),b.on("fieldsChange",function(){b._buildFields()}),b._handles={},b._buildFields(),b._bind()},destructor:function(){i.detachHandle(this._handles)},_bind:function(){function b(b){d.check()?(d.fire("submitSuccess"),a.Global.fire("formChecker:submitSuccess",{instance:d})):(b.halt(!0),d.fire("submitFailure"))}function c(a){a.halt(),d._isCheckingAsync||(d._isCheckingAsync=!0,d.checkAsync(function(a){d._isCheckingAsync=!1,window.setTimeout(function(){d.fire(a?"submitFailure":"submitSuccess")},0)}))}var d=this,e=d._handles,f=d.get("form"),g=d.get("async"),h=g?c:b;e.submit=f.on("submit",h),e.focus=f.delegate("focus",function(){var a=d._getFieldByNode(this);a&&d.focusField(a,!0)},"input, textarea, select"),e.blur=f.delegate("blur",function(){var a=d._getFieldByNode(this);a&&d.blurField(a,!0)},"input, textarea, select"),a.Global.on("formChecker:valueChange",function(a){var b=d._getFieldByNode(a.node);b&&d.blurField(b,!0)}),e.success=d.on(n,function(a){d._updateUncheckedFields&&d._updateUncheckedFields(a.field.name)}),e.failure=d.on(o,function(a){d._updateUncheckedFields&&d._updateUncheckedFields(a.field.name,!0)})},checkField:function(a){function b(a,b,c){var d={field:b};a===o&&c&&(d.error=c),e.fire(a,d)}var c,e=this,f=a.node,g=a._async;a.validateReg?c=!a.validateReg.test(f.get("value")):a.validateFn&&(c=a.validateFn.call(f,f)),c?b(o,a,c):a.validateAjax?(g&&g.isInProgress()&&g.abort(),g=d(a.validateAjax.action,{method:"POST",data:i.toPostData(a.validateAjax.dataFn()),on:{success:function(c,d){var e=i.getEvalRes(d);e.status?b(n,a):b(o,a,e.msg)},failure:function(c,d){d.statusText&&"abort"===d.statusText||b(o,a,"网络有问题，请稍后重试")}}}),g.isInProgress()&&e._processType(a,"检查中..."),a._async=g):b(n,a)},check:function(){var a=this,c=a.get("fields"),d=!1;return e.each(c,function(c){(c.status===b.STATUS_INIT||c.status===b.STATUS_CHECKING)&&a.checkField(c),c.status===b.STATUS_ERROR&&(d=!0)}),!d},checkAsync:function(a){var c=this,d=c.get("fields"),f={},g=!1;return e.each(d,function(a,c){(a.status===b.STATUS_INIT||a.status===b.STATUS_CHECKING)&&(f[c]=!0),a.status===b.STATUS_ERROR&&(g=!0)}),e.isEmpty(f)?void a(g):(c._updateUncheckedFields=function(b,d){f.hasOwnProperty(b)&&(delete f[b],d&&(g=!0),e.isEmpty(f)&&(c._updateUncheckedFields=null,a(g)))},void e.each(f,function(a,b){c.checkField(d[b])}))},focusField:function(a,b){var c=this,d=a.node,e=a.groupNode,f=c.get("highlightGroup");b||d.focus(),d.test("input[type=text], input[type=password], textarea")&&f&&e.addClass(c.className.highlightGroup),c._processType(a)},blurField:function(a,b){var c=this,d=a.node,e=c.get("highlightGroup"),f=c.get("checkEvent");b||d.blur(),e&&a.groupNode.removeClass(c.className.highlightGroup),"blur"===f?window.setTimeout(function(){c.checkField(a)},m):c.clearTip(a)},_processType:function(a,c){a.status=b.STATUS_CHECKING,c=c||a.typeTip,""===c?this.clearTip(a):this._setTip(a,this.className.type,c)},_defSuccessFn:function(a,c){var d=a.field,e=d.showOkTip;d.status=b.STATUS_OK,e?this._setTip(d,this.className.ok,c||d.okTip||""):this.clearTip(d)},_defFailureFn:function(a){var c=a.field,d=a.error;c.status=b.STATUS_ERROR,d===!0&&(d=c.errorTip),this._setTip(c,this.className.error,d||c.errorTip)},_setTip:function(a,b,d){var e,f,h=this,i=h.get("fields"),l=h.get("tipClass"),m=h.className;if(g(a)&&(a=i[a]),e=a.groupNode,f=e.one(k+l),f||(f=c.create('<span class="'+l+'"></span>'),e.append(f)),m===j["new"])switch(b){case m.type:d='<i class="tip-status"></i>'+d;break;case m.ok:d='<i class="tip-status tip-status--success"></i>'+d;break;case m.error:d='<i class="tip-status tip-status--opinfo"></i>'+d}h.replaceGroupClass(a,b),f.setHTML(d).show()},setOkTip:function(a,b){this._setTip(a,this.className.ok,b)},setErrorTip:function(a,b){this._setTip(a,this.className.error,b)},setTypeTip:function(a,b){this._setTip(a,this.className.type,b)},clearTip:function(a){var b,c,d=this,e=d.get("fields");g(a)&&(a=e[a]),b=a.groupNode,c=b.one(k+d.get("tipClass")),c&&c.setHTML("").hide(),d.replaceGroupClass(a)},replaceGroupClass:function(b,c){var d=b.groupNode,e=this.className;a.Array.each([e.type,e.ok,e.error],function(a){d.removeClass(a)}),c&&d.addClass(c)},_getFieldByNode:function(a){var b=this.get("fields"),c=null;return e.some(b,function(b){return b.node===a?(c=b,!0):void 0}),c},addField:function(c,d){var e=this,g=e.get("fields"),h=e.get("showOkTip"),i=a.one(d.node),j=i&&i.ancestor(k+e.className.fieldGroup);return i&&j?(a.mix(d,{name:c,node:i,groupNode:j,status:b.STATUS_INIT,showOkTip:d.hasOwnProperty("showOkTip")?d.showOkTip:h},!0),d.validateAjax&&!f(d.validateAjax.dataFn)&&(d.validateAjax.dataFn=function(){var a={};return a[i.get("name")]=i.get("value"),a}),g[c]=d,!0):!1},addFields:function(a){var b,c=this,d=!0;for(b in a)a.hasOwnProperty(b)&&(d=c.addField(b,a[b])&&d);return d},removeField:function(a){var b=this,c=b.get("fields"),d=g(a)?a:a.name;return c.hasOwnProperty(d)?(delete c[d],!0):!1},resetAllFields:function(){var b=this,c=b.get("fields");a.Object.each(c,function(a){b.resetField(a)})},resetField:function(a){var c=this,d=c.get("fields");g(a)&&(a=d[a]),a.status=b.STATUS_INIT,c.clearTip(a)},_buildFields:function(){var a=this,b=a.get("fields");e.each(b,function(c,d){var e=a.addField(d,c);e||delete b[d]})},_setForm:function(b){return a.one(b)}};a.extend(b,a.Base,p),a.mt.FormChecker=b},"1.0.0",{requires:["mt-base","io-base","base-base","node"]});
/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("attribute-complex",function(e,t){var n=e.Attribute;n.Complex=function(){},n.Complex.prototype={_normAttrVals:n.prototype._normAttrVals,_getAttrInitVal:n.prototype._getAttrInitVal},e.AttributeComplex=n.Complex},"3.16.0",{requires:["attribute-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("base-pluginhost",function(e,t){var n=e.Base,r=e.Plugin.Host;e.mix(n,r,!1,null,1),n.plug=r.plug,n.unplug=r.unplug},"3.16.0",{requires:["base-base","pluginhost"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("classnamemanager",function(e,t){var n="classNamePrefix",r="classNameDelimiter",i=e.config;i[n]=i[n]||"yui3",i[r]=i[r]||"-",e.ClassNameManager=function(){var t=i[n],s=i[r];return{getClassName:e.cached(function(){var n=e.Array(arguments);return n[n.length-1]!==!0?n.unshift(t):n.pop(),n.join(s)})}}()},"3.16.0",{requires:["yui-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-base",function(e,t){function R(e){var t=this,n,r,i=t.constructor;t._strs={},t._cssPrefix=i.CSS_PREFIX||s(i.NAME.toLowerCase()),e=e||{},R.superclass.constructor.call(t,e),r=t.get(T),r&&(r!==P&&(n=r),t.render(n))}var n=e.Lang,r=e.Node,i=e.ClassNameManager,s=i.getClassName,o,u=e.cached(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}),a="content",f="visible",l="hidden",c="disabled",h="focused",p="width",d="height",v="boundingBox",m="contentBox",g="parentNode",y="ownerDocument",b="auto",w="srcNode",E="body",S="tabIndex",x="id",T="render",N="rendered",C="destroyed",k="strings",L="<div></div>",A="Change",O="loading",M="_uiSet",_="",D=function(){},P=!0,H=!1,B,j={},F=[f,c,d,p,h,S],I=e.UA.webkit,q={};R.NAME="widget",B=R.UI_SRC="ui",R.ATTRS=j,j[x]={valueFn:"_guid",writeOnce:P},j[N]={value:H,readOnly:P},j[v]={valueFn:"_defaultBB",setter:"_setBB",writeOnce:P},j[m]={valueFn:"_defaultCB",setter:"_setCB",writeOnce:P},j[S]={value:null,validator:"_validTabIndex"},j[h]={value:H,readOnly:P},j[c]={value:H},j[f]={value:P},j[d]={value:_},j[p]={value:_},j[k]={value:{},setter:"_strSetter",getter:"_strGetter"},j[T]={value:H,writeOnce:P},R.CSS_PREFIX=s(R.NAME.toLowerCase()),R.getClassName=function(){return s.apply(i,[R.CSS_PREFIX].concat(e.Array(arguments),!0))},o=R.getClassName,R.getByNode=function(t){var n,i=o();return t=r.one(t),t&&(t=t.ancestor("."+i,!0),t&&(n=q[e.stamp(t,!0)])),n||null},e.extend(R,e.Base,{getClassName:function(){return s.apply(i,[this._cssPrefix].concat(e.Array(arguments),!0))},initializer:function(t){var n=this.get(v);n instanceof r&&this._mapInstance(e.stamp(n))},_mapInstance:function(e){q[e]=this},destructor:function(){var t=this.get(v),n;t instanceof r&&(n=e.stamp(t,!0),n in q&&delete q[n],this._destroyBox())},destroy:function(e){return this._destroyAllNodes=e,R.superclass.destroy.apply(this)},_destroyBox:function(){var e=this.get(v),t=this.get(m),n=this._destroyAllNodes,r;r=e&&e.compareTo(t),this.UI_EVENTS&&this._destroyUIEvents(),this._unbindUI(e),t&&(n&&t.empty(),t.remove(P)),r||(n&&e.empty(),e.remove(P))},render:function(e){return!this.get(C)&&!this.get(N)&&(this.publish(T,{queuable:H,fireOnce:P,defaultTargetOnly:P,defaultFn:this._defRenderFn}),this.fire(T,{parentNode:e?r.one(e):null})),this},_defRenderFn:function(e){this._parentNode=e.parentNode,this.renderer(),this._set(N,P),this._removeLoadingClassNames()},renderer:function(){var e=this;e._renderUI(),e.renderUI(),e._bindUI(),e.bindUI(),e._syncUI(),e.syncUI()},bindUI:D,renderUI:D,syncUI:D,hide:function(){return this.set(f,H)},show:function(){return this.set(f,P)},focus:function(){return this._set(h,P)},blur:function(){return this._set(h,H)},enable:function(){return this.set(c,H)},disable:function(){return this.set(c,P)},_uiSizeCB:function(e){this.get(m).toggleClass(o(a,"expanded"),e)},_renderBox:function(e){var t=this,n=t.get(m),i=t.get(v),s=t.get(w),o=t.DEF_PARENT_NODE,u=s&&s.get(y)||i.get(y)||n.get(y);s&&!s.compareTo(n)&&!n.inDoc(u)&&s.replace(n),!i.compareTo(n.get(g))&&!i.compareTo(n)&&(n.inDoc(u)&&n.replace(i),i.appendChild(n)),e=e||o&&r.one(o),e?e.appendChild(i):i.inDoc(u)||r.one(E).insert(i,0)},_setBB:function(e){return this._setBox(this.get(x),e,this.BOUNDING_TEMPLATE,!0)},_setCB:function(e){return this.CONTENT_TEMPLATE===null?this.get(v):this._setBox(null,e,this.CONTENT_TEMPLATE,!1)},_defaultBB:function(){var e=this.get(w),t=this.CONTENT_TEMPLATE===null;return e&&t?e:null},_defaultCB:function(e){return this.get(w)||null},_setBox:function(t,n,i,s){return n=r.one(n),n||(n=r.create(i),s?this._bbFromTemplate=!0:this._cbFromTemplate=!0),n.get(x)||n.set(x,t||e.guid()),n},_renderUI:function(){this._renderBoxClassNames(),this._renderBox(this._parentNode)},_renderBoxClassNames:function(){var e=this._getClasses(),t,n=this.get(v),r;n.addClass(o());for(r=e.length-3;r>=0;r--)t=e[r],n.addClass(t.CSS_PREFIX||s(t.NAME.toLowerCase()));this.get(m).addClass(this.getClassName(a))},_removeLoadingClassNames:function(){var e=this.get(v),t=this.get(m),n=this.getClassName(O),r=o(O);e.removeClass(r).removeClass(n),t.removeClass(r).removeClass(n)},_bindUI:function(){this._bindAttrUI(this._UI_ATTRS.BIND),this._bindDOM()},_unbindUI:function(e){this._unbindDOM(e)},_bindDOM:function(){var t=this.get(v).get(y),n=R._hDocFocus;n||(n=R._hDocFocus=t.on("focus",this._onDocFocus,this),n.listeners={count:0}),n.listeners[e.stamp(this,!0)]=!0,n.listeners.count++,I&&(this._hDocMouseDown=t.on("mousedown",this._onDocMouseDown,this))},_unbindDOM:function(t){var n=R._hDocFocus,r=e.stamp(this,!0),i,s=this._hDocMouseDown;n&&(i=n.listeners,i[r]&&(delete i[r],i.count--),i.count===0&&(n.detach(),R._hDocFocus=null)),I&&s&&s.detach()},_syncUI:function(){this._syncAttrUI(this._UI_ATTRS.SYNC)},_uiSetHeight:function(e){this._uiSetDim(d,e),this._uiSizeCB(e!==_&&e!==b)},_uiSetWidth:function(e){this._uiSetDim(p,e)},_uiSetDim:function(e,t){this.get(v).setStyle(e,n.isNumber(t)?t+this.DEF_UNIT:t)},_uiSetVisible:function(e){this.get(v).toggleClass(this.getClassName(l),!e)},_uiSetDisabled:function(e){this.get(v).toggleClass(this.getClassName(c),e)},_uiSetFocused:function(e,t){var n=this.get(v);n.toggleClass(this.getClassName(h),e),t!==B&&(e?n.focus():n.blur())},_uiSetTabIndex:function(e){var t=this.get(v);n.isNumber(e)?t.set(S,e):t.removeAttribute(S)},_onDocMouseDown:function(e){this._domFocus&&this._onDocFocus(e)},_onDocFocus:function(e){var t=R.getByNode(e.target),n=R._active;n&&n!==t&&(n._domFocus=!1,n._set(h,!1,{src:B}),R._active=null),t&&(t._domFocus=!0,t._set(h,!0,{src:B}),R._active=t)},toString:function(){return this.name+"["+this.get(x)+"]"},DEF_UNIT:"px",DEF_PARENT_NODE:null,CONTENT_TEMPLATE:L,BOUNDING_TEMPLATE:L,_guid:function(){return e.guid()},_validTabIndex:function(e){return n.isNumber(e)||n.isNull(e)},_bindAttrUI:function(e){var t,n=e.length;for(t=0;t<n;t++)this.after(e[t]+A,this._setAttrUI)},_syncAttrUI:function(e){var t,n=e.length,r;for(t=0;t<n;t++)r=e[t],this[M+u(r)](this.get(r))},_setAttrUI:function(e){e.target===this&&this[M+u(e.attrName
)](e.newVal,e.src)},_strSetter:function(t){return e.merge(this.get(k),t)},getString:function(e){return this.get(k)[e]},getStrings:function(){return this.get(k)},_UI_ATTRS:{BIND:F,SYNC:F}}),e.Widget=R},"3.16.0",{requires:["attribute","base-base","base-pluginhost","classnamemanager","event-focus","node-base","node-style"],skinnable:!0});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-htmlparser",function(e,t){var n=e.Widget,r=e.Node,i=e.Lang,s="srcNode",o="contentBox";n.HTML_PARSER={},n._buildCfg={aggregates:["HTML_PARSER"]},n.ATTRS[s]={value:null,setter:r.one,getter:"_getSrcNode",writeOnce:!0},e.mix(n.prototype,{_getSrcNode:function(e){return e||this.get(o)},_preAddAttrs:function(e,t,n){var r={id:e.id,boundingBox:e.boundingBox,contentBox:e.contentBox,srcNode:e.srcNode};this.addAttrs(r,t,n),delete e.boundingBox,delete e.contentBox,delete e.srcNode,delete e.id,this._applyParser&&this._applyParser(t)},_applyParsedConfig:function(t,n,r){return r?e.mix(n,r,!1):n},_applyParser:function(t){var n=this,r=this._getNodeToParse(),s=n._getHtmlParser(),o,u;s&&r&&e.Object.each(s,function(e,t,s){u=null,i.isFunction(e)?u=e.call(n,r):i.isArray(e)?(u=r.all(e[0]),u.isEmpty()&&(u=null)):u=r.one(e),u!==null&&u!==undefined&&(o=o||{},o[t]=u)}),t=n._applyParsedConfig(r,t,o)},_getNodeToParse:function(){var e=this.get("srcNode");return this._cbFromTemplate?null:e},_getHtmlParser:function(){var t=this._getClasses(),n={},r,i;for(r=t.length-1;r>=0;r--)i=t[r].HTML_PARSER,i&&e.mix(n,i,!0);return n}})},"3.16.0",{requires:["widget-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-skin",function(e,t){var n="boundingBox",r="contentBox",i="skin",s=e.ClassNameManager.getClassName;e.Widget.prototype.getSkinName=function(e){var t=this.get(r)||this.get(n),o,u;return e=e||s(i,""),u=new RegExp("\\b"+e+"(\\S+)"),t&&t.ancestor(function(e){return o=e.get("className").match(u),o}),o?o[1]:null}},"3.16.0",{requires:["widget-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-uievents",function(e,t){var n="boundingBox",r=e.Widget,i="render",s=e.Lang,o=":",u=e.Widget._uievts=e.Widget._uievts||{};e.mix(r.prototype,{_destroyUIEvents:function(){var t=e.stamp(this,!0);e.each(u,function(n,r){n.instances[t]&&(delete n.instances[t],e.Object.isEmpty(n.instances)&&(n.handle.detach(),u[r]&&delete u[r]))})},UI_EVENTS:e.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(n)},_createUIEvent:function(t){var n=this._getUIEventNode(),i=e.stamp(n)+t,s=u[i],o;s||(o=n.delegate(t,function(e){var t=r.getByNode(this);t&&t._filterUIEvent(e)&&t.fire(e.type,{domEvent:e})},"."+e.Widget.getClassName()),u[i]=s={instances:{},handle:o}),s.instances[e.stamp(this)]=1},_filterUIEvent:function(e){return e.currentTarget.compareTo(e.container)||e.container.compareTo(this._getUIEventNode())},_getUIEvent:function(e){if(s.isString(e)){var t=this.parseType(e)[1],n,r;return t&&(n=t.indexOf(o),n>-1&&(t=t.substring(n+o.length)),this.UI_EVENTS[t]&&(r=t)),r}},_initUIEvent:function(e){var t=this._getUIEvent(e),n=this._uiEvtsInitQueue||{};t&&!n[t]&&(this._uiEvtsInitQueue=n[t]=1,this.after(i,function(){this._createUIEvent(t),delete this._uiEvtsInitQueue[t]}))},on:function(e){return this._initUIEvent(e),r.superclass.on.apply(this,arguments)},publish:function(e,t){var n=this._getUIEvent(e);return n&&t&&t.defaultFn&&this._initUIEvent(n),r.superclass.publish.apply(this,arguments)}},!0)},"3.16.0",{requires:["node-event-delegate","widget-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("base-build",function(e,t){function f(e,t,n){n[e]&&(t[e]=(t[e]||[]).concat(n[e]))}function l(e,t,n){n._ATTR_CFG&&(t._ATTR_CFG_HASH=null,f.apply(null,arguments))}function c(e,t,r){n.modifyAttrs(t,r.ATTRS)}var n=e.BaseCore,r=e.Base,i=e.Lang,s="initializer",o="destructor",u=["_PLUG","_UNPLUG"],a;r._build=function(t,n,i,u,a,f){var l=r._build,c=l._ctor(n,f),h=l._cfg(n,f,i),p=l._mixCust,d=c._yuibuild.dynamic,v,m,g,y,b,w;for(v=0,m=i.length;v<m;v++)g=i[v],y=g.prototype,b=y[s],w=y[o],delete y[s],delete y[o],e.mix(c,g,!0,null,1),p(c,g,h),b&&(y[s]=b),w&&(y[o]=w),c._yuibuild.exts.push(g);return u&&e.mix(c.prototype,u,!0),a&&(e.mix(c,l._clean(a,h),!0),p(c,a,h)),c.prototype.hasImpl=l._impl,d&&(c.NAME=t,c.prototype.constructor=c,c.modifyAttrs=n.modifyAttrs),c},a=r._build,e.mix(a,{_mixCust:function(t,n,r){var s,o,u,a,f,l;r&&(s=r.aggregates,o=r.custom,u=r.statics),u&&e.mix(t,n,!0,u);if(s)for(l=0,f=s.length;l<f;l++)a=s[l],!t.hasOwnProperty(a)&&n.hasOwnProperty(a)&&(t[a]=i.isArray(n[a])?[]:{}),e.aggregate(t,n,!0,[a]);if(o)for(l in o)o.hasOwnProperty(l)&&o[l](l,t,n)},_tmpl:function(t){function n(){n.superclass.constructor.apply(this,arguments)}return e.extend(n,t),n},_impl:function(e){var t=this._getClasses(),n,r,i,s,o,u;for(n=0,r=t.length;n<r;n++){i=t[n];if(i._yuibuild){s=i._yuibuild.exts,o=s.length;for(u=0;u<o;u++)if(s[u]===e)return!0}}return!1},_ctor:function(e,t){var n=t&&!1===t.dynamic?!1:!0,r=n?a._tmpl(e):e,i=r._yuibuild;return i||(i=r._yuibuild={}),i.id=i.id||null,i.exts=i.exts||[],i.dynamic=n,r},_cfg:function(t,n,r){var i=[],s={},o=[],u,a=n&&n.aggregates,f=n&&n.custom,l=n&&n.statics,c=t,h,p;while(c&&c.prototype)u=c._buildCfg,u&&(u.aggregates&&(i=i.concat(u.aggregates)),u.custom&&e.mix(s,u.custom,!0),u.statics&&(o=o.concat(u.statics))),c=c.superclass?c.superclass.constructor:null;if(r)for(h=0,p=r.length;h<p;h++)c=r[h],u=c._buildCfg,u&&(u.aggregates&&(i=i.concat(u.aggregates)),u.custom&&e.mix(s,u.custom,!0),u.statics&&(o=o.concat(u.statics)));return a&&(i=i.concat(a)),f&&e.mix(s,n.cfgBuild,!0),l&&(o=o.concat(l)),{aggregates:i,custom:s,statics:o}},_clean:function(t,n){var r,i,s,o=e.merge(t),u=n.aggregates,a=n.custom;for(r in a)o.hasOwnProperty(r)&&delete o[r];for(i=0,s=u.length;i<s;i++)r=u[i],o.hasOwnProperty(r)&&delete o[r];return o}}),r.build=function(e,t,n,r){return a(e,t,n,null,null,r)},r.create=function(e,t,n,r,i){return a(e,t,n,r,i)},r.mix=function(e,t){return e._CACHED_CLASS_DATA&&(e._CACHED_CLASS_DATA=null),a(null,e,t,null,null,{dynamic:!1})},n._buildCfg={aggregates:u.concat(),custom:{ATTRS:c,_ATTR_CFG:l,_NON_ATTRS_CFG:f}},r._buildCfg={aggregates:u.concat(),custom:{ATTRS:c,_ATTR_CFG:l,_NON_ATTRS_CFG:f}}},"3.16.0",{requires:["base-base"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stdmod",function(e,t){function H(e){}var n=e.Lang,r=e.Node,i=e.UA,s=e.Widget,o="",u="hd",a="bd",f="ft",l="header",c="body",h="footer",p="fillHeight",d="stdmod",v="Node",m="Content",g="firstChild",y="childNodes",b="ownerDocument",w="contentBox",E="height",S="offsetHeight",x="auto",T="headerContentChange",N="bodyContentChange",C="footerContentChange",k="fillHeightChange",L="heightChange",A="contentUpdate",O="renderUI",M="bindUI",_="syncUI",D="_applyParsedConfig",P=e.Widget.UI_SRC;H.HEADER=l,H.BODY=c,H.FOOTER=h,H.AFTER="after",H.BEFORE="before",H.REPLACE="replace";var B=H.HEADER,j=H.BODY,F=H.FOOTER,I=B+m,q=F+m,R=j+m;H.ATTRS={headerContent:{value:null},footerContent:{value:null},bodyContent:{value:null},fillHeight:{value:H.BODY,validator:function(e){return this._validateFillHeight(e)}}},H.HTML_PARSER={headerContent:function(e){return this._parseStdModHTML(B)},bodyContent:function(e){return this._parseStdModHTML(j)},footerContent:function(e){return this._parseStdModHTML(F)}},H.SECTION_CLASS_NAMES={header:s.getClassName(u),body:s.getClassName(a),footer:s.getClassName(f)},H.TEMPLATES={header:'<div class="'+H.SECTION_CLASS_NAMES[B]+'"></div>',body:'<div class="'+H.SECTION_CLASS_NAMES[j]+'"></div>',footer:'<div class="'+H.SECTION_CLASS_NAMES[F]+'"></div>'},H.prototype={initializer:function(){this._stdModNode=this.get(w),e.before(this._renderUIStdMod,this,O),e.before(this._bindUIStdMod,this,M),e.before(this._syncUIStdMod,this,_)},_syncUIStdMod:function(){var e=this._stdModParsed;(!e||!e[I])&&this._uiSetStdMod(B,this.get(I)),(!e||!e[R])&&this._uiSetStdMod(j,this.get(R)),(!e||!e[q])&&this._uiSetStdMod(F,this.get(q)),this._uiSetFillHeight(this.get(p))},_renderUIStdMod:function(){this._stdModNode.addClass(s.getClassName(d)),this._renderStdModSections(),this.after(T,this._afterHeaderChange),this.after(N,this._afterBodyChange),this.after(C,this._afterFooterChange)},_renderStdModSections:function(){n.isValue(this.get(I))&&this._renderStdMod(B),n.isValue(this.get(R))&&this._renderStdMod(j),n.isValue(this.get(q))&&this._renderStdMod(F)},_bindUIStdMod:function(){this.after(k,this._afterFillHeightChange),this.after(L,this._fillHeight),this.after(A,this._fillHeight)},_afterHeaderChange:function(e){e.src!==P&&this._uiSetStdMod(B,e.newVal,e.stdModPosition)},_afterBodyChange:function(e){e.src!==P&&this._uiSetStdMod(j,e.newVal,e.stdModPosition)},_afterFooterChange:function(e){e.src!==P&&this._uiSetStdMod(F,e.newVal,e.stdModPosition)},_afterFillHeightChange:function(e){this._uiSetFillHeight(e.newVal)},_validateFillHeight:function(e){return!e||e==H.BODY||e==H.HEADER||e==H.FOOTER},_uiSetFillHeight:function(e){var t=this.getStdModNode(e),n=this._currFillNode;n&&t!==n&&n.setStyle(E,o),t&&(this._currFillNode=t),this._fillHeight()},_fillHeight:function(){if(this.get(p)){var e=this.get(E);e!=o&&e!=x&&this.fillHeight(this.getStdModNode(this.get(p)))}},_uiSetStdMod:function(e,t,r){if(n.isValue(t)){var i=this.getStdModNode(e,!0);this._addStdModContent(i,t,r),this.set(e+m,this._getStdModContent(e),{src:P})}else this._eraseStdMod(e);this.fire(A)},_renderStdMod:function(e){var t=this.get(w),n=this._findStdModSection(e);return n||(n=this._getStdModTemplate(e)),this._insertStdModSection(t,e,n),this[e+v]=n,this[e+v]},_eraseStdMod:function(e){var t=this.getStdModNode(e);t&&(t.remove(!0),delete this[e+v])},_insertStdModSection:function(e,t,n){var r=e.get(g);if(t===F||!r)e.appendChild(n);else if(t===B)e.insertBefore(n,r);else{var i=this[F+v];i?e.insertBefore(n,i):e.appendChild(n)}},_getStdModTemplate:function(e){return r.create(H.TEMPLATES[e],this._stdModNode.get(b))},_addStdModContent:function(e,t,n){switch(n){case H.BEFORE:n=0;break;case H.AFTER:n=undefined;break;default:n=H.REPLACE}e.insert(t,n)},_getPreciseHeight:function(e){var t=e?e.get(S):0,n="getBoundingClientRect";if(e&&e.hasMethod(n)){var r=e.invoke(n);r&&(t=r.bottom-r.top)}return t},_findStdModSection:function(e){return this.get(w).one("> ."+H.SECTION_CLASS_NAMES[e])},_parseStdModHTML:function(t){var n=this._findStdModSection(t);return n?(this._stdModParsed||(this._stdModParsed={},e.before(this._applyStdModParsedConfig,this,D)),this._stdModParsed[t+m]=1,n.get("innerHTML")):null},_applyStdModParsedConfig:function(e,t,n){var r=this._stdModParsed;r&&(r[I]=!(I in t)&&I in r,r[R]=!(R in t)&&R in r,r[q]=!(q in t)&&q in r)},_getStdModContent:function(e){return this[e+v]?this[e+v].get(y):null},setStdModContent:function(e,t,n){this.set(e+m,t,{stdModPosition:n})},getStdModNode:function(e,t){var n=this[e+v]||null;return!n&&t&&(n=this._renderStdMod(e)),n},fillHeight:function(e){if(e){var t=this.get(w),r=[this.headerNode,this.bodyNode,this.footerNode],s,o,u=0,a=0,f=!1;for(var l=0,c=r.length;l<c;l++)s=r[l],s&&(s!==e?u+=this._getPreciseHeight(s):f=!0);f&&((i.ie||i.opera)&&e.set(S,0),o=t.get(S)-parseInt(t.getComputedStyle("paddingTop"),10)-parseInt(t.getComputedStyle("paddingBottom"),10)-parseInt(t.getComputedStyle("borderBottomWidth"),10)-parseInt(t.getComputedStyle("borderTopWidth"),10),n.isNumber(o)&&(a=o-u,a>=0&&e.set(S,a)))}}},e.WidgetStdMod=H},"3.16.0",{requires:["base-build","widget"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position",function(e,t){function d(e){}var n=e.Lang,r=e.Widget,i="xy",s="position",o="positioned",u="boundingBox",a="relative",f="renderUI",l="bindUI",c="syncUI",h=r.UI_SRC,p="xyChange";d.ATTRS={x:{setter:function(e){this._setX(e)},getter:function(){return this._getX()},lazyAdd:!1},y:{setter:function(e){this._setY(e)},getter:function(){return this._getY()},lazyAdd:!1},xy:{value:[0,0],validator:function(e){return this._validateXY(e)}}},d.POSITIONED_CLASS_NAME=r.getClassName(o),d.prototype={initializer:function(){this._posNode=this.get(u),e.after(this._renderUIPosition,this,f),e.after(this._syncUIPosition,this,c),e.after(this._bindUIPosition,this,l)},_renderUIPosition:function(){this._posNode.addClass(d.POSITIONED_CLASS_NAME)},_syncUIPosition:function(){var e=this._posNode;e.getStyle(s)===a&&this.syncXY(),this._uiSetXY(this.get(i))},_bindUIPosition:function(){this.after(p,this._afterXYChange)},move:function(){var e=arguments,t=n.isArray(e[0])?e[0]:[e[0],e[1]];this.set(i,t)},syncXY:function(){this.set(i,this._posNode.getXY(),{src:h})},_validateXY:function(e){return n.isArray(e)&&n.isNumber(e[0])&&n.isNumber(e[1])},_setX:function(e){this.set(i,[e,this.get(i)[1]])},_setY:function(e){this.set(i,[this.get(i)[0],e])},_getX:function(){return this.get(i)[0]},_getY:function(){return this.get(i)[1]},_afterXYChange:function(e){e.src!=h&&this._uiSetXY(e.newVal)},_uiSetXY:function(e){this._posNode.setXY(e)}},e.WidgetPosition=d},"3.16.0",{requires:["base-build","node-screen","widget"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-align",function(e,t){function c(e){}var n=e.Lang,r="align",i="alignOn",s="visible",o="boundingBox",u="offsetWidth",a="offsetHeight",f="region",l="viewportRegion";c.ATTRS={align:{value:null},centered:{setter:"_setAlignCenter",lazyAdd:!1,value:!1},alignOn:{value:[],validator:e.Lang.isArray}},c.TL="tl",c.TR="tr",c.BL="bl",c.BR="br",c.TC="tc",c.RC="rc",c.BC="bc",c.LC="lc",c.CC="cc",c.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionAlign is added"),e.after(this._bindUIPosAlign,this,"bindUI"),e.after(this._syncUIPosAlign,this,"syncUI")},_posAlignUIHandles:null,destructor:function(){this._detachPosAlignUIHandles()},_bindUIPosAlign:function(){this.after("alignChange",this._afterAlignChange),this.after("alignOnChange",this._afterAlignOnChange),this.after("visibleChange",this._syncUIPosAlign)},_syncUIPosAlign:function(){var e=this.get(r);this._uiSetVisiblePosAlign(this.get(s)),e&&this._uiSetAlign(e.node,e.points)},align:function(e,t){return arguments.length?this.set(r,{node:e,points:t}):this._syncUIPosAlign(),this},centered:function(e){return this.align(e,[c.CC,c.CC])},_setAlignCenter:function(e){return e&&this.set(r,{node:e===!0?null:e,points:[c.CC,c.CC]}),e},_uiSetAlign:function(t,r){if(!n.isArray(r)||r.length!==2){e.error("align: Invalid Points Arguments");return}var i=this._getRegion(t),s,o,u;if(!i)return;s=r[0],o=r[1];switch(o){case c.TL:u=[i.left,i.top];break;case c.TR:u=[i.right,i.top];break;case c.BL:u=[i.left,i.bottom];break;case c.BR:u=[i.right,i.bottom];break;case c.TC:u=[i.left+Math.floor(i.width/2),i.top];break;case c.BC:u=[i.left+Math.floor(i.width/2),i.bottom];break;case c.LC:u=[i.left,i.top+Math.floor(i.height/2)];break;case c.RC:u=[i.right,i.top+Math.floor(i.height/2)];break;case c.CC:u=[i.left+Math.floor(i.width/2),i.top+Math.floor(i.height/2)];break;default:}u&&this._doAlign(s,u[0],u[1])},_uiSetVisiblePosAlign:function(e){e?this._attachPosAlignUIHandles():this._detachPosAlignUIHandles()},_attachPosAlignUIHandles:function(){if(this._posAlignUIHandles)return;var t=this.get(o),n=e.bind(this._syncUIPosAlign,this),r=[];e.Array.each(this.get(i),function(i){var s=i.eventName,o=e.one(i.node)||t;s&&r.push(o.on(s,n))}),this._posAlignUIHandles=r},_detachPosAlignUIHandles:function(){var t=this._posAlignUIHandles;t&&((new e.EventHandle(t)).detach(),this._posAlignUIHandles=null)},_doAlign:function(e,t,n){var r=this._posNode,i;switch(e){case c.TL:i=[t,n];break;case c.TR:i=[t-r.get(u),n];break;case c.BL:i=[t,n-r.get(a)];break;case c.BR:i=[t-r.get(u),n-r.get(a)];break;case c.TC:i=[t-r.get(u)/2,n];break;case c.BC:i=[t-r.get(u)/2,n-r.get(a)];break;case c.LC:i=[t,n-r.get(a)/2];break;case c.RC:i=[t-r.get(u),n-r.get(a)/2];break;case c.CC:i=[t-r.get(u)/2,n-r.get(a)/2];break;default:}i&&this.move(i)},_getRegion:function(t){var n;return t?(t=e.Node.one(t),t&&(n=t.get(f))):n=this._posNode.get(l),n},_afterAlignChange:function(e){var t=e.newVal;t&&this._uiSetAlign(t.node,t.points)},_afterAlignOnChange:function(e){this._detachPosAlignUIHandles(),this.get(s)&&this._attachPosAlignUIHandles()}},e.WidgetPositionAlign=c},"3.16.0",{requires:["widget-position"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stack",function(e,t){function O(e){}var n=e.Lang,r=e.UA,i=e.Node,s=e.Widget,o="zIndex",u="shim",a="visible",f="boundingBox",l="renderUI",c="bindUI",h="syncUI",p="offsetWidth",d="offsetHeight",v="parentNode",m="firstChild",g="ownerDocument",y="width",b="height",w="px",E="shimdeferred",S="shimresize",x="visibleChange",T="widthChange",N="heightChange",C="shimChange",k="zIndexChange",L="contentUpdate",A="stacked";O.ATTRS={shim:{value:r.ie==6},zIndex:{value:0,setter:"_setZIndex"}},O.HTML_PARSER={zIndex:function(e){return this._parseZIndex(e)}},O.SHIM_CLASS_NAME=s.getClassName(u),O.STACKED_CLASS_NAME=s.getClassName(A),O.SHIM_TEMPLATE='<iframe class="'+O.SHIM_CLASS_NAME+'" frameborder="0" title="Widget Stacking Shim" src="javascript:false" tabindex="-1" role="presentation"></iframe>',O.prototype={initializer:function(){this._stackNode=this.get(f),this._stackHandles={},e.after(this._renderUIStack,this,l),e.after(this._syncUIStack,this,h),e.after(this._bindUIStack,this,c)},_syncUIStack:function(){this._uiSetShim(this.get(u)),this._uiSetZIndex(this.get(o))},_bindUIStack:function(){this.after(C,this._afterShimChange),this.after(k,this._afterZIndexChange)},_renderUIStack:function(){this._stackNode.addClass(O.STACKED_CLASS_NAME)},_parseZIndex:function(e){var t;return!e.inDoc()||e.getStyle("position")==="static"?t="auto":t=e.getComputedStyle("zIndex"),t==="auto"?null:t},_setZIndex:function(e){return n.isString(e)&&(e=parseInt(e,10)),n.isNumber(e)||(e=0),e},_afterShimChange:function(e){this._uiSetShim(e.newVal)},_afterZIndexChange:function(e){this._uiSetZIndex(e.newVal)},_uiSetZIndex:function(e){this._stackNode.setStyle(o,e)},_uiSetShim:function(e){e?(this.get(a)?this._renderShim():this._renderShimDeferred(),r.ie==6&&this._addShimResizeHandlers()):this._destroyShim()},_renderShimDeferred:function(){this._stackHandles[E]=this._stackHandles[E]||[];var e=this._stackHandles[E],t=function(e){e.newVal&&this._renderShim()};e.push(this.on(x,t))},_addShimResizeHandlers:function(){this._stackHandles[S]=this._stackHandles[S]||[];var e=this.sizeShim,t=this._stackHandles[S];t.push(this.after(x,e)),t.push(this.after(T,e)),t.push(this.after(N,e)),t.push(this.after(L,e))},_detachStackHandles:function(e){var t=this._stackHandles[e],n;if(t&&t.length>0)while(n=t.pop())n.detach()},_renderShim:function(){var e=this._shimNode,t=this._stackNode;e||(e=this._shimNode=this._getShimTemplate(),t.insertBefore(e,t.get(m)),this._detachStackHandles(E),this.sizeShim())},_destroyShim:function(){this._shimNode&&(this._shimNode.get(v).removeChild(this._shimNode),this._shimNode=null,this._detachStackHandles(E),this._detachStackHandles(S))},sizeShim:function(){var e=this._shimNode,t=this._stackNode;e&&r.ie===6&&this.get(a)&&(e.setStyle(y,t.get(p)+w),e.setStyle(b,t.get(d)+w))},_getShimTemplate:function(){return i.create(O.SHIM_TEMPLATE,this._stackNode.get(g))}},e.WidgetStack=O},"3.16.0",{requires:["base-build","widget"],skinnable:!0});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-constrain",function(e,t){function m(e){}var n="constrain",r="constrain|xyChange",i="constrainChange",s="preventOverlap",o="align",u="",a="bindUI",f="xy",l="x",c="y",h=e.Node,p="viewportRegion",d="region",v;m.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}},v=m._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}},m.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added"),e.after(this._bindUIPosConstrained,this,a)},getConstrainedXY:function(e,t){t=t||this.get(n);var r=this._getRegion(t===!0?null:t),i=this._posNode.get(d);return[this._constrain(e[0],l,i,r),this._constrain(e[1],c,i,r)]},constrain:function(e,t){var r,i,s=t||this.get(n);s&&(r=e||this.get(f),i=this.getConstrainedXY(r,s),(i[0]!==r[0]||i[1]!==r[1])&&this.set(f,i,{constrained:!0}))},_setConstrain:function(e){return e===!0?e:h.one(e)},_constrain:function(e,t,n,r){if(r){this.get(s)&&(e=this._preventOverlap(e,t,n,r));var i=t==l,o=i?r.width:r.height,u=i?n.width:n.height,a=i?r.left:r.top,f=i?r.right-u:r.bottom-u;if(e<a||e>f)u<o?e<a?e=a:e>f&&(e=f):e=a}return e},_preventOverlap:function(e,t,n,r){var i=this.get(o),s=t===l,a,f,c,h,p,d;return i&&i.points&&v[t][i.points.join(u)]&&(f=this._getRegion(i.node),f&&(a=s?n.width:n.height,c=s?f.left:f.top,h=s?f.right:f.bottom,p=s?f.left-r.left:f.top-r.top,d=s?r.right-f.right:r.bottom-f.bottom),e>c?d<a&&p>a&&(e=c-a):p<a&&d>a&&(e=h)),e},_bindUIPosConstrained:function(){this.after(i,this._afterConstrainChange),this._enableConstraints(this.get(n))},_afterConstrainChange:function(e){this._enableConstraints(e.newVal)},_enableConstraints:function(e){e?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on(r,this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(e){e.constrained||(e.newVal=this.getConstrainedXY(e.newVal))},_getRegion:function(e){var t;return e?(e=h.one(e),e&&(t=e.get(d))):t=this._posNode.get(p),t}},e.WidgetPositionConstrain=m},"3.16.0",{requires:["widget-position"]});

/*
YUI 3.16.0 (build 76f0e08)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("overlay",function(e,t){e.Overlay=e.Base.create("overlay",e.Widget,[e.WidgetStdMod,e.WidgetPosition,e.WidgetStack,e.WidgetPositionAlign,e.WidgetPositionConstrain])},"3.16.0",{requires:["widget","widget-stdmod","widget-position","widget-position-align","widget-stack","widget-position-constrain"],skinnable:!0});

M.add("mt-dialog",function(a){function b(){var c=arguments[0],d=b._instances[c.id];return c.useAnim=c.useAnim?a.mt.UIUtil.isSupportAnimation().animation&&a.mt.UIUtil.isSupportAnimation().transform:!1,d instanceof b?(d.setAttrs(c),d):(b._instances[c.id]=this,b.superclass.constructor.apply(this,arguments),this.config=c,this)}var c=a.UA.ie,d=6===c,e=a.Lang.isString,f=a.Lang.isNumber,g=a.mt.util,h=a.mt.macro.key,i={CLOSE:"close",OPEN:"open"};b._instances={},b.NAME="mt-dialog",b.MASK_ID="mt-overlay-mask",b.IFRAME_ID="mt-overlay-iframe",b.UNDERLAY_CLASS="mt-overlay-underlay",b.OVERLAY_CONTAINER_CLASS="mt-overlay-container",b.TITLE_TPL='<h3 class="head">{title}<span class="close">关闭</span></h3><div class="body"><p class="error" style="display:none">&nbsp;</p>{content}</div>',b.NO_TITLE_TPL='<a class="close no-title" hidefocus="true">关闭</a><div class="body"><p class="error" style="display:none">&nbsp;</p>{content}</div>',b.ATTRS={id:{value:null,writeOnce:!0},width:{value:"420px",setter:"_setWidth"},zIndex:{value:102},align:{value:null},centered:{value:!0},modal:{value:!0},autoHide:{value:!1},title:{value:""},content:{value:""},useAnim:{value:!1}};var j={initializer:function(){var a=this;a._timer=null,a._dialog=null,a._scrollHandle=null,a._escHandle=null,a.publish("open",{emitFacade:!0,defaultFn:a._defOpenFn}),a.publish("close",{emitFacade:!0,defaultFn:a._defCloseFn}),a._initDialog(),a._bind()},destructor:function(){var c=this,d=a.one(a.config.doc),e=d.one("#"+b.IFRAME_ID),f=d.one("#"+b.MASK_ID);c._dialog.destroy(),c._escHandle.detach(),c._scrollHandle&&c._scrollHandle.detach(),a.one("#"+c.get("id")).destroy(!0),e&&e.destroy(!0),f&&f.destroy(!0),delete b._instances[c.get("id")]},_initDialog:function(){var b=this,c=b.getAttrs(["width","zIndex","align","centered"]);c.visible=!1,b._dialog=new a.Overlay(c),b._initOverlay()},_bind:function(){var b=this;b.on("widthChange",function(a){this._dialog.set("width",a.newVal),b.resizeUnderlay()}),b.on("titleChange",function(a){b._fillTemplate({title:a.newVal})}),b.on("contentChange",function(a){b._fillTemplate({content:a.newVal})}),b.on("centeredChange",function(a){this._dialog.set("centered",a.newVal)}),b.on("alignChange",function(a){this._dialog.set("align",a.newVal)}),b.on("autoHideChange",function(a){a.newVal&&(b._timer=window.setTimeout(function(){b.close()},1e3*parseInt(a.newVal,10)))}),b._escHandle=a.one("body").on("keydown",function(a){a.keyCode===h.ESC&&b._status===i.OPEN&&b.close()}),a.one("#"+b.get("id")).delegate("click",function(){b.close()},".close")},_fillTemplate:function(c){var d,e,f,g=this;c=c||{},d=c.title||g.get("title"),e=c.content||g.get("content"),(d||e)&&(f=d?a.Lang.sub(b.TITLE_TPL,{title:d,content:e}):a.Lang.sub(b.NO_TITLE_TPL,{content:e}),g._dialog.set("bodyContent",'<div class="mt-dialog">'+f+"</div>"),g.get("centered")&&g.set("centered",!0),g.resizeUnderlay())},_initOverlay:function(){var c,e=this,f=e.get("modal"),g=e.get("zIndex"),h=e.get("id"),i=e._dialog,j=a.one(document.body),k=j.one("#"+b.IFRAME_ID),l=j.one("#"+b.MASK_ID);f&&(d&&!k&&(k=a.Node.create('<iframe id="'+b.IFRAME_ID+'"></iframe>'),j.prepend(k)),l||(l=a.Node.create('<div id="'+b.MASK_ID+'"></div>'),k?k.insert(l,"before"):j.prepend(l)),k&&k.setStyles({width:j.get("docWidth"),height:j.get("docHeight"),zIndex:parseInt(g,10)-2,visibility:"hidden"}),l.setStyles({width:j.get("docWidth"),height:j.get("docHeight"),zIndex:parseInt(g,10)-1,visibility:"hidden"})),c=a.Node.create('<div id="'+h+'" class="'+b.OVERLAY_CONTAINER_CLASS+'"></div>'),k?k.insert(c,"after"):j.prepend(c),i.render(c),e._fillTemplate(),c.one("."+b.UNDERLAY_CLASS)||c.get("firstChild").append('<div class="'+b.UNDERLAY_CLASS+'"></div>')},open:function(){var a=this,b=a.get("id");a.fire("open",{id:b})},_defOpenFn:function(){var c=this,d=c._dialog,e=c.get("centered"),f=c.get("autoHide"),h=a.one(window),j=a.one(document),k=j.one("#"+b.IFRAME_ID),l=j.one("#"+b.MASK_ID),m=c.get("id"),n=j.one("#"+m);k&&k.setStyle("visibility","visible"),l&&l.setStyles({width:j.get("docWidth"),height:j.get("docHeight"),visibility:"visible"}),this.get("useAnim")?setTimeout(function(){d.show(),n.one(".mt-dialog").addClass("anim-popup"),n.one(".mt-overlay-underlay").addClass("anim-popup")},0):d.show(),c._status=i.OPEN,f&&c.set("autoHide",f),e&&(c.set("centered",!0),c._scrollHandle=h.on(["scroll","resize"],g.throttle(function(){c.set("centered",!0)},100)))},close:function(){var a=this,b=a.get("id");a.fire("close",{id:b})},_defCloseFn:function(){var c=this,d=c.get("modal"),e=c.get("centered"),f=c.get("id"),g=c._dialog,h=a.one(document.body),j=h.one("#"+b.MASK_ID),k=h.one("#"+b.IFRAME_ID),l=h.one("#"+f);this.get("useAnim")?l.all(".anim-popup").each(function(b){b.removeClass("anim-popup"),b.addClass("anim-hide-popup"),a.mt.UIUtil.bindAnimEndEvent(b,function(a,b){a.animationName&&"hide-popup"===a.animationName&&(g.hide(),b.removeClass("anim-hide-popup"))})}):g.hide(),c._status=i.CLOSE,d&&(j.setStyle("visibility","hidden"),k&&k.setStyle("visibility","hidden")),e&&c._scrollHandle&&c._scrollHandle.detach(),l&&l.all(".close").each(function(a){a.purge()}),window.clearTimeout(c._timer),c.config.onClose&&c.config.onClose(c)},resizeUnderlay:function(){var e,f,g=this,h=g.get("id");if(d||7===c&&"BackCompat"===document.compatMode){if(e=a.one("#"+h+" ."+b.UNDERLAY_CLASS),!e)return;f=e.ancestor(),e.setStyles({width:parseFloat(f.getComputedStyle("width"))+12+"px",height:parseFloat(f.getComputedStyle("height"))+12+"px"})}},one:function(b){return a.one("#"+this.get("id")).one(b)},all:function(b){return a.one("#"+this.get("id")).all(b)},showError:function(a){this.one(".body > .error").setHTML(a).show()},clearError:function(){this.one(".body > .error").hide()},showResult:function(b,c){var d="350px",e='<div class="result-box result-box--{className} pngfix"><i></i><h5>{title}</h5>{tip}</div>{extra}',f='<div class="result-box result-box--{className} result-box--alert pngfix"><table class="alert-table"><tr><td width="35"><i class="alert-icon"></i></td><td><div class="alert-msg">{tip}</div></td></tr></table></div>',g={tip:{className:"tip",title:"",extra:""},success:{className:"success",title:"操作成功",extra:""},failure:{className:"failure",title:"操作失败",extra:""}};a.mix(b,g[b.type||"success"]),b.tip?b.tip="<p>"+b.tip+"</p>":(b.tip="",b.className+=" no-tip"),this.setAttrs({width:b.width||d,content:a.Lang.sub(c?f:e,b)})},_setWidth:function(a){return e(a)?a:f(a)?a+"px":"420px"}};a.extend(b,a.Base,j),a.mt.Dialog=b},"1.0.0",{requires:["mt-base","overlay","node","base","mt-uiutil"]});
M.add("www-dialog",function(a){var b=a.io,c=a.Lang.isFunction,d=a.Lang.trim,e=a.Lang.sub,f=a.mt.util,g=f.Cookie,h=a.mt.www,i=h.REG,j=a.mt.Dialog,k=a.mt.FormChecker;a.namespace("mt.www.Dialog"),h.Dialog=a.merge(h.Dialog,{alert:function(b,c){var d,e=a.mt.Dialog,f=e._instances;"string"==typeof b&&(b={tip:b}),b.id="mt-alert-dialog",b.title=c||"",b.type="tip",a.each(f,function(a){"open"===a._status&&(a._needReopen=!0,a.close())}),d=new e(b),d.open(),d.showResult(b,!0),b.autoHide||d.set("autoHide",b.autoHide),b.reload?d.on("close",function(){window.location.reload()}):d.on("close",function(){a.each(f,function(a){a._needReopen&&(a.open(),delete a._needReopen)})})},login:function(b,d){function e(c){var e;d?e=d:c.loginRef&&(e=function(a){a.loginRef&&""!==a.loginRef?location.href=a.loginRef:location.reload()}),window._mbq("eventlog","unitivelogin","getjs","www"),a.Get.js("/account/fetchunitiveloginscript",function(){var d,f,g=window.passport;window._mbq("eventlog","unitivelogin","jsloaded","www"),f={ndContentWrapper:c.ndWrapper.getDOMNode(),extraCallback:e},"meituan.com"!==M.DOMAIN_HOST&&(d=2===M.DEV?"http://www."+M.DOMAIN_HOST:M.DOMAIN_HOST,f=a.merge(f,{env:d})),g.init(f),b.plainQueryString?g.login({plainQueryString:b.plainQueryString}):g.login({service:"www","continue":"http://www."+M.DOMAIN_HOST+"/account/settoken",origin:b.origin})})}function f(){window._gaq&&window._gaq.push(["_trackEvent","Dialog","view",b.galabel])}var h,i,k="wwwlr",l="common-login-dialog",m="unitive-login-iframe";return 1===arguments.length&&c(arguments[0])&&(d=arguments[0],b={}),a.mix(b,{galabel:"common/login",origin:"dialog"}),h=new j({id:l,title:"登录",width:"440px",content:'<div class="J-content-wrapper" style="height:440px"></div>',useAnim:!0}),h.open(),i=a.one("#"+l),i.one("#"+m)||e({ndWrapper:i.one(".J-content-wrapper"),callback:d,loginRef:b.loginRef}),h.setCookie=function(a,b){b=b||g.getExpiresDate(1,0,0),g.set(k,a,b,"/","."+M.DOMAIN_HOST)},b.loginRef&&h.setCookie(b.loginRef,b.expiresDate),f(),h},Email:{_ID:"email-bind-dialog",tips:{type:"请填写邮箱地址",empty:"请填写邮箱地址",error:"邮箱格式错误，请重新输入"},bind:function(c,d){function e(){function a(a){var b;a.status?(m.after("close",function(){window.location.reload()}),n.activate(a.email,a.url)):(b="captcha"===a.errortype?e.get("fields").captcha:e.get("fields").email,e.setErrorTip(b,a.msg),p.refresh(i))}var e,i=m.one("form"),j=f.field(i,"email"),l=f.field(i,"captcha");p.bindRefreshEvent(i),e=new k({form:i,fields:{email:{node:j,validateFn:g,typeTip:o.type},captcha:{node:l,validateFn:p.check,typeTip:p.tips.type}},tipClass:k.CLASS_BLOCK_TIP}),i.on("submit",function(e){e.halt();var g;g=c?"/account/bindemail/modify"+(d?"/verified":""):"/account/bindemail",b(g,{method:"POST",form:{id:i},on:{success:function(b,c){var d=f.getEvalRes(c);a(d)},failure:function(){var a={type:"failure",tip:"请求失败，请稍候重试",autoHide:3,reload:!0};h.Dialog.showResult(m,a)}}})})}function g(a){var b=a.get("value");return""===b?o.empty:i.email.test(b)?!1:o.error}var l=a.one("#email-bind-dialog-markup");if(l){var m,n=this,o=n.tips,p=h.Dialog.Captcha;m=new j({id:n._ID,width:"470px",title:"绑定邮箱",content:l.getHTML()}),m.open(),e()}},activate:function(b,c){var d=a.one("#email-activate-dialog-markup");if(d){var f,g=this;f=new j({id:g._ID,width:"470px",title:"绑定邮箱",content:e(d.getHTML(),{email:b,url:c})}),f.open()}}},Password:{tips:{thesamepwd:"当前密码和新密码一致，请重新输入",currentpwd:"请输入当前密码",emptypwd:"请输入新密码",whitespace:"密码中不能包含空格",password:"建议使用与您其它账户不同的密码",emptypwd2:"请再次输入新密码",password2:"请再次输入密码以确认",notequal:"密码不一致，请重新输入"},set:function(a){this._set(a)},reset:function(a){this._set(a,!0)},_set:function(c,d){function g(){function e(a){p.setHTML(a).show(),h.disableButton(o,!1)}i=s.one("form"),l=f.field(i,"currentpassword"),m=f.field(i,"password"),n=f.field(i,"password2"),o=f.field(i,"commit"),p=i.one(".error"),a.use("www-passwordstrength",function(){m.on("keyup",function(){h.PasswordStrength.check(m.get("value"))})}),q=new k({form:i,fields:{},tipClass:k.CLASS_BLOCK_TIP,async:!0}),d&&q.addField("currentPassword",{node:l,validateFn:t.getCheckMethod(q,0)}),q.addFields({password:{node:m,validateFn:t.getCheckMethod(q,1),typeTip:t.tips.password},password2:{node:n,validateFn:t.getCheckMethod(q,2)}}),q.on("submitSuccess",function(a){a.halt(),h.disableButton(o),r&&r.isInProgress()||(r=b(i.get("action"),{method:"POST",form:{id:i},on:{success:function(a,b){var d,g=f.getEvalRes(b);g.status?(d={type:"success",title:"设置成功！"},g.growth&&g.growth>0&&(d.tip='您已获得<span class="growth-dialog-focus">'+parseInt(g.growth,10)+"个成长值</span>"),s.showResult(d),s.on("close",function(){c.reload?window.location.reload():g.redirect&&(window.location.href=g.redirect)}),s.set("autoHide",3)):e(g.msg)},failure:function(){e("网络故障，请稍后重试")}}}))})}var i,l,m,n,o,p,q,r,s=null,t=this,u=a.one("#J-set-password-dialog-markup"),v={tip:"",currentPasswordField:"",mobileField:""},w="set-password-dialog",x='<div class="field-group"><label>当前密码</label><input type="password" name="currentpassword" id="current-password" class="f-text" autocomplete="off" /></div>',y='<div class="field-group"><label class="text">手机号</label>{mobile}</div>';c=c||{},a.mix(v,c,!0,["tip"]),d?(v.action="/account/settings",v.currentPasswordField=x):(v.action="/account/addpassword",c.mobile&&(v.mobileField=e(y,{mobile:c.mobile}))),s=new j({id:w,width:"400px",title:"设置密码",content:e(u.getHTML(),v)}),s.open(),g()},getCheckMethod:function(a,b){function c(a,b){var c=b||"",d=/\s/,f=/^[\x21-\x7e]{6,32}$/i;switch(c){case"current":if(""===a)return e.currentpwd;break;case"password":if(""===a)return e.emptypwd;if(d.test(a))return e.whitespace;if(!f.test(a))return e.password;break;case"password2":if(""===a)return e.emptypwd2}return!1}var d=a.get("fields"),e=this.tips;switch(b){case 0:return function(a){return c(a.get("value"),"current")};case 1:return function(b){var f,g,h,i=b.get("value");return h=c(i,"password"),h!==!1?h:d.currentPassword&&(f=d.currentPassword.node.get("value"),f===i)?e.thesamepwd:(g=d.password2.node.get("value"),g&&c(g,"password2")===!1&&a.checkField(d.password2),!1)};case 2:return function(a){var b,f,g=a.get("value");return f=c(g,"password2"),f!==!1?f:(b=d.password.node.get("value"),b!==g?e.notequal:!1)};default:return function(){return!1}}}},Mobile:{bind:function(b,c){var d,e=null,f="mobile-bind-dialog";if(!b){if(d=a.one("#mobile-bind-dialog-markup"),!d)return;b=d.getHTML()}e=new j({id:f,width:"450px",title:"绑定手机号码",content:b}),e.open(),c?this.initSmsUpBind(e.one("form"),{dialog:e}):this.initBinder(e)},initBinder:function(a){function c(a){var b=d(a.get("value"));return""===b?"手机号不能为空":i.mobile.test(b)?!1:"请输入正确的11位手机号"}function e(a){return""===a?"图片验证码不能为空":4!==a.length?"请填入正确的图片验证码":!1}function g(a){var b=d(a.get("value"));return""===b?"动态码不能为空":!1}function j(a){return a?(a='<i class="tip-status tip-status--opinfo"></i>'+a,void w.setHTML(a).show()):void w.setHTML("").hide()}function l(){function a(d){p&&p.isInProgress()||(p=b("/account/bindsendnew",{method:"POST",data:f.toPostData(d),on:{success:function(b,e){var i=f.getEvalRes(e);i.data&&i.data.needconfirm?window.confirm(i.msg)&&(d.confirm=!0,a(d)):i.status?(h.disableButton(s,!1),h.disableButton(x,!1),c()):g(i,d.mobileNum)},failure:function(){j("网络有问题，请稍后重试。")}}}))}function c(){var a,b=60;A=!0,j(!1),y&&(u.hide(),y=!1),h.disableButton(t),a=window.setInterval(function(){b-=1,b?t.set("value","已发送，"+b+"秒后可重新获取"):(window.clearInterval(a),t.set("value","重新获取"),h.disableButton(t,!1))},1e3)}function g(a,b){if(j(a.msg),A=!1,a.errType)switch(a.errType){case 2:z=b,u.hide(),h.disableButton(t);break;case 3:y=!0,o.update(),u.show(),v.focus()}}var i,l,m,n=B.get("fields").mobile;t.on("click",function(){if(B.checkField(n),n.status===k.STATUS_OK){if(l=d(r.get("value")),m=d(v.get("value")),!y)return void a({mobile:l});i=e(m),i?(u.addClass("form-field--error"),j(i)):a({mobile:l,captcha:m})}})}function m(b){a.after("close",function(){window.location.reload()});var c={};c.type="success",c.tip=b.msg,b.growth&&b.growth>0&&(c.tip='您已获得<span class="growth-dialog-focus">'+parseInt(b.growth,10)+"个成长值</span>"),c.autoHide=2,h.Dialog.showResult(a,c)}function n(a){j(a.msg),1===a.errType&&(h.disableButton(s),h.disableButton(x)),x.set("value","登录")}var o,p,q=a.one("form"),r=f.field(q,"mobile"),s=f.field(q,"verifycode"),t=q.one("#mobile-verify"),u=q.one(".form-field--captcha"),v=f.field(q,"captcha"),w=q.one("#validate-info"),x=q.one("#J-bind-btn"),y=!1,z="",A=!1,B=new k({form:q,fields:{mobile:{node:r,validateFn:c,typeTip:""},verifyCode:{node:s,validateFn:g,typeTip:""}},tipClass:k.CLASS_INLINE_TIP,checkEvent:"blur",showOkTip:!1,async:!0});o=h.refreshCaptcha(q,!0,"captcha"),r.on("keyup",function(){var a=d(r.get("value"));""!==z&&11===a.length&&z!==a&&(y=!1,u.hide(),j(!1),t.set("value","获取动态码"),h.disableButton(t,!1))}),l(),B.on("submitSuccess",function(a){return a.halt(),A?void(p&&p.isInProgress()||(x.set("value","登录中..."),p=b(q.get("action"),{method:"POST",form:{id:q},on:{success:function(a,b){var c=f.getEvalRes(b);c.status?m(c):n(c)},failure:function(){j("网络有问题，请稍后重试。")}}}))):void j("请先获取手机动态码")})},initSmsUpBind:function(c,d){function e(b,c){var e=f.getEvalRes(c),i=a.one("#J-upstream-sms-content"),j=a.one("#J-upstream-sms-receiver");e.status?(r.hide(),s.show(),q.setHTML(e.maskmobile),i.setHTML(e.verifycode),j.setHTML(e.damobile),a.mt.www.Dialog.Mobile.initSmsUpChecker(t,a.merge({successFn:g,failFn:h,failMsg:"您发送的短信暂时无法收到，建议您咨询客服解决",type:"绑定"},d))):u({tip:e.msg,reload:!0})}function g(a){v=o;var b="绑定成功";a.growth&&a.growth>0&&(b='您已获得<span class="growth-dialog-focus">'+parseInt(a.growth,10)+"个成长值</span>"),u({tip:b,reload:!0,autoHide:5})}function h(){v=n}function i(){var a=j.get("value");return""===a?"请输入手机号":/^\d{11}$/.test(a)?(v=m,!1):"请输入正确的11位手机号码"}var j=a.one("#J-smsup-bind-input");if(j){var k,l=1,m=2,n=3,o=4,p=a.one("#J-smsup-bind-next"),q=a.one("#J-smsup-bind-mask"),r=a.one("#J-smsup-bind-step1"),s=a.one("#J-smsup-bind-step2"),t=a.one("#J-smsup-bind-check"),u="undefined"!=typeof a.mt.www.Dialog.alert?a.mt.www.Dialog.alert:window.alert,v=l;d=d||{},c&&c.on("submit",function(a){switch(i(),v){case o:return!0;case l:u("请输入正确的手机号");break;case n:case m:u("您尚未完成手机号码绑定")}return a.halt(),!1}),p.on("click",function(a){if(a.halt(),!k||!k.isInProgress()){var c=i();return c?u(c):void(k=b(p.getData("action"),{method:"POST",data:f.toPostData({mobile:j.get("value")}),on:{success:e}}))}})}},initSmsUpRebind:function(c,d){function e(b,c){var e=f.getEvalRes(c),i=a.one("#J-upstream-sms-content"),j=a.one("#J-upstream-sms-receiver");e.status?(s.hide(),t.show(),r.setHTML(e.maskmobile),i.setHTML(e.verifycode),j.setHTML(e.damobile),a.mt.www.Dialog.Mobile.initSmsUpChecker(u,a.merge({successFn:g,failFn:h,failMsg:"您发送的短信暂时无法收到，建议您咨询客服解决",type:"绑定"},d))):v({tip:e.msg,reload:!0})}function g(a){w=p;var b="绑定成功";a.growth&&a.growth>0&&(b='您已获得<span class="growth-dialog-focus">'+parseInt(a.growth,10)+"个成长值</span>"),v({tip:b,reload:!0,autoHide:5})}function h(){w=o}function i(){var a=j.get("value"),b=k.get("value");return""===b?"请输入原手机号":""===a?"请输入新手机号":/^\d{11}$/.test(a)&&/^\d{11}$/.test(b)?b===a?"新手机号不能和原手机号相同":(w=n,!1):"请输入正确的11位手机号码"}var j=a.one("#J-smsup-bind-input"),k=a.one("#J-smsup-bind-input-old");if(j&&k){var l,m=1,n=2,o=3,p=4,q=a.one("#J-smsup-bind-next"),r=a.one("#J-smsup-bind-mask"),s=a.one("#J-smsup-bind-step1"),t=a.one("#J-smsup-bind-step2"),u=a.one("#J-smsup-bind-check"),v="undefined"!=typeof a.mt.www.Dialog.alert?a.mt.www.Dialog.alert:window.alert,w=m;d=d||{},c&&c.on("submit",function(a){switch(i(),w){case p:return!0;case m:v("请输入正确的手机号");break;case o:case n:v("您尚未完成手机号码绑定")}return a.halt(),!1}),q.on("click",function(a){if(a.halt(),!l||!l.isInProgress()){var c=i();return c?v(c):void(l=b(q.getData("action"),{method:"POST",data:f.toPostData({mobile:j.get("value"),oldmobile:k.get("value")}),on:{success:e}}))}})}},initSmsUpChecker:function(c,d){function e(){!r&&n?(n%m===0&&h(),c.set("value","系统将在("+n+"秒)内完成"+k)):(window.clearInterval(i),r||h(g)),n-=1}function g(){r||(o(d.failMsg),n=l,c.set("value",k+"失败，请重发短信后再次确认").set("disabled",!1).removeClass(p))}function h(a){j=b(q,{method:"POST",data:f.toPostData(d.data),on:{success:function(b,c){var e=f.getEvalRes(c);e.status=parseInt(e.status,10),0===e.status?(r=!0,d.successFn&&d.successFn(e)):1===e.status?o({tip:e.msg,reload:!0}):(r=!1,d.failFn&&d.failFn(e)),a&&a(e)},failure:function(){o("网络异常，请重试"),c.set("disabled",!1).removeClass(p)}}})}if(c=a.one(c)){var i,j,k,l=60,m=10,n=l,o="undefined"!=typeof a.mt.www.Dialog.alert?a.mt.www.Dialog.alert:window.alert,p="btn-disabled",q=c.getData("action"),r=!1,s={successFn:function(){},failFn:function(){},type:"注册",failMsg:""};d=a.merge(s,d),k=d.type,c.on("click",function(){c.addClass(p).set("disabled",!0).set("value","系统将在("+n+")内完成"+k),e(),i=window.setInterval(e,1e3)}),d.dialog&&d.dialog.on&&d.dialog.on("close",function(){i&&window.clearInterval(i)})}},_performVerify:function(a){if(a.ndForm){var c=a.config||{},d=a.ndForm.one('input[type="submit"]'),e=a.ndVerifyMsg||null,g="error";h.disableButton(d,!0),e&&(e.removeClass(g),e.setHTML("")),b(a.ndForm.get("action"),{method:"POST",form:{id:a.ndForm},on:{success:function(b,i){var j,k=f.getEvalRes(i);k.status?a.callback?a.callback(k):(c.type=k.status?"success":"failure",j=k.msg,k.growth&&k.growth>0&&(j='您已获得<span class="growth-dialog-focus">'+parseInt(k.growth,10)+"个成长值</span>"),c.tip=j,c.autoHide=2,h.Dialog.showResult(a.dialog,c)):(h.disableButton(d,!1),e?(e.addClass(g),e.setHTML(k.msg)):h.Dialog.alert(k.msg))},failure:function(){h.disableButton(d,!1)}}})}},_check:function(a){return/^\d{11}$/.test(a.get("value"))?!1:"请输入正确的11位手机号码"}},Captcha:{tips:{type:"请输入图片中的字符，不区分大小写",empty:"请输入验证码",error:"验证码输入错误，请重新输入"},bindRefreshEvent:function(a){if(a){var b=a.one(".captcha-refresh"),c=a.one(".signup-captcha-img"),d=this;b&&c&&a.delegate("click",function(b){b.halt(),d.refresh(a)},".signup-captcha-img, .captcha-refresh")}},refresh:function(a){var b=a.one(".signup-captcha-img"),c=b.getAttribute("src").replace(/(\?0\.\d+)?$/,"");b.setAttribute("src",c+"?"+Math.random())},check:function(a){var b=a.get("value"),c=h.Dialog.Captcha.tips;return""===b?c.empty:4!==b.length?c.error:!1}},showResult:function(a,b){b=b||{},b.title||(b.title="success"===b.type?"操作成功":"操作失败"),a.showResult(b),void 0!==b.autoHide&&a.set("autoHide",b.autoHide),b.reload&&a.after("close",function(){window.location.reload()}),b.onClose&&a.after("close",function(){b.onClose(a)})},createResultDialog:function(a,b,c){c=c||"MT_SHOW_RESULT_DIALOG";var d=new j({id:c,title:b||""});d.open(),this.showResult(d,a)}})},"1.0.0",{requires:["www-base","mt-formchecker","mt-dialog"]});
M.add("www-ratelist",function(a){var b={buildSingleRatePicItem:function(a){var b,c,d,e;if(!a)return"";if(e=a.length,!e)return"";for(d='<div class="pic-list J-piclist-wrapper"><div class="J-pic-thumbnails pic-thumbnails"><ul class="pic-thumbnail-list">',b=0;e>b;b++)c=a[b],d+='<li data-src="'+c.url+'"><a class="pic-thumbnail" href="#" hidefocus="true">    <img src="'+c.url.replace("/w.h/","/126.126/")+'"/></a></li>';return d+='</ul></div><div class="J-pic-preview pic-preview"></div></div>'},renderRatePicList:function(b){if(b){var c=b.all(".J-piclist-wrapper");c.isEmpty()||a.use("w-carousel",function(a){c.each(function(b){new a.mt.widget.Carousel({contentBox:b,ndCarousel:".J-pic-preview",ndIndicatorWrap:".J-pic-thumbnails",fillLastPage:!0,getCarouselSrc:function(a){return a.getData("src").replace("/w.h/","/668.500/")}}).render()})})}}};a.namespace("mt.www.Ratelist"),a.mt.www.Ratelist=b},"1.0.0",{requires:["www-base"]});
M.add("www-sku",function(a){a.namespace("mt.www.Sku"),a.mt.www.Sku={initTypeSelection:function(a){var b,c,d,e,f,g="J-type-selected";a.delegate("click",function(){var h=a.one(".J-cart-quantity"),i=h.getData("max")-0;if(c=a.one("."+g),this.hasClass(g)||(this.addClass(g),a.one(".J-dealgood-id").set("value",this.getAttribute("data-dealgoodsid"))),c&&(c.removeClass(g),a.one(".J-dealgood-id").set("value","0")),c=a.one("."+g),d=a.one(".J-buy-form"),e=d.hasClass("deal-select-incomplete"),e?c&&(d.removeClass("deal-select-incomplete"),a.one(".J-remind-continue").show(),a.one(".remind__bottom").hide()):c||(d.addClass("deal-select-incomplete"),a.one(".J-remind-continue").hide(),a.one(".remind__bottom").show()),f=a.one(".deal-component-quantity-warning"),b=h.get("value")-0,f.setHTML(""),a.one(".J-type-selected")){var j=a.one(".J-type-selected").getData("dealgoodsrest");b>j&&i>j&&f.setHTML("还剩 "+j+"单")}},".J-type-select a")},initRemindClose:function(a){var b;a.delegate("click",function(){b=a.one(".J-buy-form"),b.removeClass("deal-buy-select-remind"),b.one(".J-type-remind").hide(),a.one(".deal-component-purchase-button").show()},".J-remind-close")},initNeedSelect:function(b,c,d){var e=a.one(".J-remind-continue"),f=b.currentTarget.cloneNode(!0);"INPUT"===f.get("tagName")?f.set("value","确定"):"A"===f.get("tagName")&&f.set("innerHTML","确定"),f.setAttribute("class",d+" btn J-select-continue"),f.removeAttribute("id"),e.setHTML(f);var g,h=184;c.one(".J-type-showall")&&""!==c.one(".J-type-showall").get("innerHTML")&&(c.one(".J-type-list").removeClass("type-list--fold"),c.one(".J-type-list").addClass("type-list--all"),g=parseInt(c.one(".J-type-list").get("scrollHeight"),10),g>h&&c.one(".J-type-select").addClass("type-showall-color-gradient"),c.one(".J-type-showall").remove(!0)),c.one(".J-buy-form").addClass("deal-buy-select-remind"),b.currentTarget.hasClass(d)||c.one(".J-select-continue").addClass(d),c.one(".deal-component-purchase-button").hide(),c.one(".J-type-remind").show();var i,j=a.UA.webkit?document.body:document.documentElement,k=a.one(".deal-component-container").getY();a.UA.ie&&a.UA.ie<9?window.scrollTo(0,k):(i=new a.Anim({node:j,duration:1,to:{scroll:[0,k]},easing:"easeOutStrong"}),i.run())},initTypeSelectAll:function(a){function b(b){var c,d,e=!0,f=92,g=184,h="type-list--fold",i="type-list--all",j='全部<i class="fold-tri fold-tri--down"></i>';b&&(c=b.ancestor().one(".J-type-list"),c&&(d=parseInt(c.get("scrollHeight"),10),f>=d||(b.setHTML(j),b.on("click",function(f){f.halt(),e&&(c.removeClass(h),c.addClass(i),d=parseInt(c.get("scrollHeight"),10),d>g&&a.one(".J-type-select").addClass("type-showall-color-gradient"),b.remove(!0))}))))}var c,d,e;for(c=a.all(".J-type-showall"),d=c.size(),e=0;d>e;++e)b(c.item(e))}}},"1.0.0");
M.add("www-add-cart",function(a){var b=a.io,c=a.mt.util;a.mt.www.AddCart={init:function(d,e,f){a.use("www-dialog","www-tracker",function(a){function g(b){var c;if(f===!0)return void(window.location.href="/cart/");if(c=b.recommendResult,void 0===c)l.createResultDialog({type:"success",title:"成功加入购物车！",tip:b.msg||"",extra:r},"",t),n.updateDropdownList();else{var d,e=a.one("#addcart-recdeal-markup"),g="cart-result-deals-dialog";d=new m({id:g,width:"590px",height:"360px",content:a.Lang.sub(e.getHTML(),{title:"成功加入购物车！",tip:b.msg||"",operate:r,deals:c})}),n.updateDropdownList(),d.open()}}function h(a){a=a||{},l.createResultDialog({type:"failure",title:"添加失败！",tip:a.msg||"",extra:s},"",t)}function i(){l.createResultDialog({type:"failure",title:"添加失败！",tip:"网络繁忙，请稍后再试。"},"",t)}var j,k=a.mt.www,l=k.Dialog,m=a.mt.Dialog,n=k.CartEx,o='<a href="javascript:void(0);" gaevent="content/main/addtocart/continue" class="close btn btn-cart btn-cart--left">&laquo;继续浏览</a>',p='<a href="/cart" gaevent="content/main/addtocart/cartcheckout" class="btn btn-hot btn-cart">去购物车结算&raquo;</a>',q='<a href="/cart" class="btn btn-hot btn-cart">整理购物车&raquo;</a>',r='<div class="operate">'+o+p+"</div>",s='<div class="operate">'+o+q+"</div>",t="cart-result-dialog";a.one("body").delegate("click",function(f){f.preventDefault();var l=c.data(f.currentTarget,"dealid"),m=c.data(f.currentTarget,"cityid"),n=a.one(".J-price-selection-container"),o=a.one(".J-price-id-input"),p=o?o.get("value"):0,q=0,r=1;if(e){var s=a.one(e);s&&(r=parseInt(s.get("value"),10)||1)}if(n){var t,u=!1,v=a.one(".deal-component-container").getY(),w=a.UA.webkit?document.body:document.documentElement,x=n.all(".J-price-selection");if(x.each(function(a){a.hasClass("deal-detail-selection-item--current")&&(u=!0,p=a.getData("priceid"))}),!u)return void(a.UA.ie&&a.UA.ie<9?(window.scrollTo(0,v),n.one(".price-selection").addClass("price-selection--confirm")):(t=new a.Anim({node:w,duration:1,to:{scroll:[0,v]},easing:"easeOutStrong"}),t.on("end",function(){n.one(".price-selection").addClass("price-selection--confirm")}),t.run()))}if(a.one(".deal-select-incomplete"))return void k.Sku.initNeedSelect(f,a.one(".deal-component-container"),d.substr(1));a.one(".J-type-selected")&&(q=a.one(".J-type-selected").getData("dealgoodsid"));var y="/cart/add/"+l+"/"+m;y=a.mt.www.tracker.appendTrackingParams(y),j&&j.isInProgress()&&j.abort(),j=b(y,{method:"POST",data:c.toPostData({quantity:r,calendarid:p,dealgoodsid:q}),on:{success:function(a,b){var d=c.getEvalRes(b);d.status?g(d):h(d)},failure:function(){i()}}})},d)})}}},"1.0.0",{requires:["www-base","www-dialog","www-tracker","www-sku"]});
M.add("www-deal",function(a){var b=a.io,c=a.UA.ie,d=6===c,e=a.Lang.isArray,f=a.Lang.trim,g=a.mt.util,h=a.mt.www,i=a.mt.www.tracker,j=a.mt.Dialog,k=a.mt.www.Ratelist;a.namespace("mt.www.Deal"),a.mt.www.Deal={refresh:function(b){function c(a,b){if(1>a)return void window.location.reload();var d=b&&b.one("span"),e=parseInt(a/86400,10),f=parseInt(a/3600%24,10),g=parseInt(a/60%60,10),h=parseInt(a%60,10),i=[];!d||e>0||(f>0?(i.push("<strong>"+f+"</strong>小时"),i.push("<strong>"+g+"</strong>分"),i.push("<strong>"+h+"</strong>秒")):g>0?(i.push("<strong>"+g+"</strong>分"),i.push("<strong>"+h+"</strong>秒")):i.push("<strong>"+h+"</strong>秒"),d.setHTML(i.join("")),a--,window.setTimeout(function(){c(a,b)},1e3))}b=e(b)?b:[b],a.Array.each(b,function(b){var d=a.one("#deal-timeleft-"+b);d&&d.hasClass("deal-on")&&c(d.getAttribute("diff"),d)})},Tracker:{init:function(){h.trackPageScroll("deal/scroll")}},SideTopic:{init:function(){M.load(function(){a.use("w-slider",function(a){var b=new a.mt.widget.Slider({srcNode:"#J-side-topic",effect:"slideFadeIn",sheetContainer:".J-side-topic-list",previous:".side-box--topic--previous",next:".side-box--topic--next",width:239,interval:2e3});b.render()})})}},NavBuyBtn:{update:function(b,c){if(c&&b){var d=a.one(document.createDocumentFragment());d.appendChild(c),b.setHTML(d.get("firstChild").get("innerHTML")),d=null}}},BottomBuyBtn:{update:function(a,b){b&&a&&a.setHTML(b)}},MyReview:{update:function(b,c){var d=a.JSON.parse(c);if(d.blkMyReview&&b){b.append(d.blkMyReview);var e,f,g=a.one(".to-rate"),h="";g&&g.hide(),d.picinfo&&(h=a.Node.create(k.buildSingleRatePicItem(d.picinfo)),e=a.one(".J-myreview"),f=e.one(".J-normal-view"),f.appendChild(h),k.renderRatePicList(e))}}},UserReviews:{update:function(b,c){var d=a.JSON.parse(c);if(d.showFeedback&&b){var e=a.mt.www.Deal;e.initUserReviews({dealId:d.dealid,cityId:d.cityid,isLogin:d.isLogin,loginRef:d.loginRefForFeedback})}}},MovieSchedule:{update:function(b,c){if(c&&b){var d=a.one(document.createDocumentFragment());d.appendChild(c),b.setHTML(d.get("firstChild").get("innerHTML")),d=null;var e=a.mt.www.Deal,f="#movie-schedule";a.mt.www.ImageLazyLoader.init(f),e.initMovieInfo(f)}}},initDynamicInfo:function(c){function d(b){var c=a.one("#bd");if(b.getStatusTip&&c&&M.load(function(){a.use("www-tips",function(a){a.mt.www.SysMsg.init(b.getStatusTip,"#bd")})}),b.blkDirectedUserDialog||b.blkPC2MobileDialog||b.blkMagiccard181Dialog||b.campaignMagiccardDialog){var d=a.Node.create("<div></div>"),e={id:"welcome-dialog",width:380};if(b.blkMagiccard181Dialog)d.setHTML(b.blkMagiccard181Dialog);else if(b.blkPC2MobileDialog)d.setHTML(b.blkPC2MobileDialog);else if(b.blkDirectedUserDialog){var f,g,i=a.Node.create("<div></div>"),k={width:380};i.setHTML(b.blkDirectedUserDialog),c.append(i),f=a.one("#directedUser-dialog-markup"),k.content=f.getHTML(),g=new j(k),g.open()}else if(b.campaignMagiccardDialog){var l,m,n=a.Node.create("<div></div>"),o={width:380};n.setHTML(b.campaignMagiccardDialog),c.append(n),l=a.one("#campaignEvent-dialog-markup"),o.content=l.getHTML(),m=new j(o),m.open()}c.append(d);var p=a.one("#welcome-dialog-markup"),q=document.location.search;if(p&&q.indexOf("urpid=tenpay%7C_%7C")<0){e.content=p.getHTML();var r=new j(e);r.open()}}b.blkPC2MobileTip&&c.prepend(b.blkPC2MobileTip),h.selectAndCopy("#share-copy-text","#share-copy-button")}var e=c.action,f=c.method||"GET",i=c.cb||null,k="referrer"in document?document.referrer:window.location.href;-1===e.indexOf("?")&&window.location.search&&(e+=window.location.search),k&&(e+=(-1===e.indexOf("?")?"?":"&")+"__referer="+encodeURIComponent(k));var l=a.Lang.now();b(e,{method:f,on:{success:function(a,b){var c=g.getEvalRes(b);h.trackApiTiming(c.bem||null,l,"deal-dynamic"),i?i.call(null,b.responseText):c.status&&d(c.data)}}})},initReferralLotteryDialog:function(){function b(){if(c)c.open();else{var b=a.one("#referral-lottery-dialog-markup");c=new j({id:d,title:"本单说明",width:"580px",content:b.getHTML()}),c.open(),a.one("#"+d+" .J-view-detail").on("click",function(){c.close(),window.location.href=g})}}var c,d="referral-lottery-dialog",e=a.one("#referral-lottery-link"),f="#anchor-referral-lottery",g=a.one(f)?f:"#anchor-detail";e&&e.on("click",function(){b()})},addFavorite:function(b,c){function d(){n&&n.isInProgress()||(n=a.io("/collection/add/"+b,{method:"POST",data:{url:t},on:{success:function(a,b){var c=g.getEvalRes(b);2===c.status?i():1===c.status?f():0===c.status?(h.Dialog.alert(c.msg),e()):h.Dialog.alert("网络有问题，请稍后重试")},failure:function(){}}}))}function e(){if(l){l.replaceClass(c,"in-favorite"),l.setAttribute("title","您已经收藏过本单");var a=l.one(".J-fav-count");if(a){var b=0|a.getHTML();a.setHTML(b+1),a.addClass("orange"),l.one("span").addClass("finish")}}}function f(){l&&(e(),a.use("w-simpledialog",function(){var b=new a.mt.widget.SimpleDialog({id:"add-favorite-dialog",node:l,width:160,content:a.one("#J-favorite-dialog").getHTML(),location:"tl",autoHide:2e3});b.open()}))}function i(){a.use("www-dialog",function(){m?m.open():m=h.Dialog.login({origin:"deal-favorite",galabel:"deal/favorite/login"})})}function j(){var a=g.Cookie.getExpiresDate(1,0,0);g.Cookie.set(r,b,a,"/","."+M.DOMAIN_HOST)}function k(){g.Cookie.remove(r,"/","."+M.DOMAIN_HOST)}c=c||"add-favorite";var l,m,n,o,p,q,r="addfav",s=a.one("."+c),t=location.href;s&&(p=s.getData("login"),q="false"===p?!1:!0,o=parseInt(g.Cookie.get(r),10),b=parseInt(b,10),q&&o===b?(k(),d()):a.one("body").delegate("click",function(a){l=a.currentTarget,a.preventDefault(),q?d():(j(),i())},"."+c))},handleWeddingContactSubmission:function(c){function d(){var d=a.one("#deal-weddingPhone-markup"),e="";if(!d)return e;var f=d.getHTML();return b("/deal/mobilecontact/"+c,{method:"GET",sync:!0,on:{success:function(b,c){var d=g.getEvalRes(c),h=g.decodeJSON(d.mobile);null===h&&(h=""),e=a.Lang.sub(f,{mobile:h})},failure:function(){}}}),e}var e;a.one("body").delegate("click",function(b){b.halt();var c=a.one(".J-error-wedding");c&&"none"!==c.getStyle("display")&&c.setStyle("display","none");var f=d(),g=b.target;a.use("w-bubbletip",function(a){e||(e=new a.mt.widget.BubbleTip({node:g,id:"wdBubbleTip",alignment:"bottom",showClose:!0,forceClose:!0,showType:"click",tip:f})),e.render(),e.show()})},".J-component-contact-phone-service")},initMobileOnlyDialog:function(){function c(){if(m)m.open();else{var b=a.one("#download-cli-dialog-markup"),c=b.getAttribute("isseckill")?"520px":"820px";m=new j({id:q,title:"扫描二维码，立即去抢购",width:c,content:b.getHTML()}),n=m.one("form"),p=g.field(n,"mobile"),o=g.field(n,"captcha"),n&&d(),m.open()}}function d(){a.use("mt-formchecker",function(a){var c,d,f=a.mt.FormChecker,j=n.get("action");p.plug(a.mt.plugin.Placeholder),h.refreshCaptcha(n,!0),d=new f({form:n,fields:{mobile:{node:p,validateFn:i,typeTip:"填写手机号，下载地址将发送到您的手机上"},captcha:{node:o,validateFn:k}},tipClass:f.CLASS_BLOCK_TIP}),n.on("submit",function(a){a.halt(),c&&c.isInProgress()||(c=b(j,{method:"POST",form:{id:n},on:{success:function(a,b){var c=g.getEvalRes(b);c.status?e(!0):e(!1,c.msg)},failure:function(){}}}))})})}function e(a,b){var c,d=5;c=a?{type:"success",title:"短信发送成功！",tip:"短信可能有延迟，请耐心等待"}:{type:"failure",title:"短信发送失败！",tip:b},m.showResult(c),m.set("autoHide",d),m=null}function i(){var a=p.get("value"),b=/^0{0,1}(13[0-9]|15[0-9]|18[0-9])[0-9]{8}$/;return 0===a.length?"手机号不能为空":b.test(a)?!1:"请输入11位手机号码"}function k(){var a=f(o.get("value")).length;return 0===a?"验证码不能为空":4!==a?"请输入正确的验证码":!1}var l=a.one(".deal-buy--mobileonly");if(l&&!+l.getData("hasinit")){l.setData("hasinit",1),l.get("disabled")&&l.set("disabled",!1);var m,n,o,p,q="download-cli-dialog";l&&l.on("click",function(a){a.preventDefault(),c()})}},initDetailNavbar:function(b){function c(){var a=q.get("pageYOffset"),c=b.one(".buy-group"),f=u>a?"up":"down";u=a,"up"===f?a<j.getY()?(c&&c.hide(),b.removeClass(r),l.hide(),d&&b.setStyle("top","auto")):d&&b.setStyle("top",a):a>j.getY()&&(b.addClass(r),c&&c.show(),b.next("."+t)?l.show():b.insert(l,"after"),d&&b.setStyle("top",a)),e()}function e(){function a(){m.each(function(a){a.ancestor("li").removeClass(s)}),m.filter('[data-anchor="'+w[d][0]+'"]').item(0).ancestor("li").addClass(s)}for(var c=0,d=0,e=b.getY()+p;c<w.length;){if(o&&e>=o)m.each(function(a){a.ancestor("li").removeClass(s)});else{if(!(e>=w[c][1])){a();break}d=c,c===w.length-1&&a()}c++}}function f(){var b=[];m.each(function(c){var d=c.getData("anchor"),e=a.one(d),f=[];e&&(f[0]=d,f[1]=e.getY(),b.push(f))}),o=n.get("region").bottom,w=b}function g(b){var c,d,e,f,g,j,k,l,m=a.UA.webkit?document.body:document.documentElement,n=a.one(b),o=a.one(".J-cart-quantity"),p=a.one(".J-price-id-input"),q=!1,r=p?p.get("value"):0;n&&n.delegate("click",function(b){return b.halt(),e=a.one(".J-price-selection-container"),c=a.one(".J-type-selected"),d=a.one(".deal-select-incomplete"),f=a.one(".deal-component-container").getY(),j=this.get("href"),k=o?"?q="+o.get("value"):"?q=1",d?(h.Sku.initNeedSelect(b,a.one(".deal-component-container"),"J-buy"),void(a.UA.ie&&a.UA.ie<9?window.scrollTo(0,f):(l=new a.Anim({node:m,duration:1,to:{scroll:[0,f]},easing:"easeOutStrong"}),l.run()))):(c&&(k+="&dealgoodsid="+c.getAttribute("data-dealgoodsid")),void(e?(g=e.all(".J-price-selection"),g.each(function(a){a.hasClass("deal-detail-selection-item--current")&&(q=!0,r=a.getData("priceid"))}),q?(k+="&calendarid="+r,window.location.href=i.appendTrackingParams(j+k)):a.UA.ie&&a.UA.ie<9?(window.scrollTo(0,f),e.one(".price-selection").addClass("price-selection--confirm")):(l=new a.Anim({node:m,duration:1,to:{scroll:[0,f]},easing:"easeOutStrong"}),l.on("end",function(){e.one(".price-selection").addClass("price-selection--confirm")}),l.run())):(0!==r&&(k+="&calendarid="+r),window.location.href=i.appendTrackingParams(j+k))))},".J-buy")}var j,k,l,m,n,o,p,q=M.window,r="common-fixed",s="content-navbar__item--current",t="common-fix-placeholder",u=0,v=10,w=[];b=a.one(b),b&&!d&&(m=b.all("[data-anchor]"),0!==m.size()&&(p=b.get("offsetHeight")+v+5,n=a.one(m.item(m.size()-1).getData("anchor")),j=b.ancestor(),k=parseInt(b.getComputedStyle("height"),10),l=a.Node.create('<div class="'+t+'" style="height:'+k+'px;"></div>'),a.Global.on("PageHeight:change",function(){f(),e()}),a.all("#deal-stuff img").each(function(a){a.getAttribute("height")||a.on("load",function(){f(),e()})}),g(".deal-component-container"),g(b),g("#J-bottom-buy"),f(),q.scroll(c,12)))},initMovieInfo:function(c){var d=a.one(c);if(d){var e,f=d.one(".accordion-content");f&&f.plug(a.mt.plugin.Effect),d.delegate("click",function(){var c=this.ancestor(".accordion-tab"),f=c.one(".accordion-content"),h=d.one(".biz-link"),i=g.data(c,"id"),j=h.getAttribute("href").replace(/\d+#/,i+"#");f?("none"===f.getStyle("display")?f.effect.slideDown():f.effect.slideUp(),c.toggleClass("accordion-tab-selected")):(c.append('<div class="accordion-content" style="display:none;"><a gaevent="dealmovie/movieshop" class="biz-link" href="'+j+'" target="_blank">查看详细排片表 &raquo;</a></div>'),f=c.one(".accordion-content"),f.plug(a.mt.plugin.Effect),e&&e.isInProgress()&&e.abort(),e=b("/deal/movieshows/"+i,{method:"GET",on:{success:function(a,b){var d=g.getEvalRes(b),e=d.data,h=d.hasSeatSelection;h&&f.one(".biz-link").setHTML("影院在线选座 &raquo;"),f.appendChild(e),f.effect.slideDown(),c.toggleClass("accordion-tab-selected")},failure:function(){}}}))},".accordion-label"),d.delegate("click",function(){var a=this;if(!a.hasClass("current")){var c,d=a.ancestor(".accordion-tab"),f=d.one(".accordion-content"),h=f.one(".current"),i=g.data(h,"date"),j=f.one(".c-"+i),k=g.data(a,"date"),l=f.one(".c-"+k);l?(j.hide(),l.show(),h.removeClass("current"),a.addClass("current"),f.setStyle("height","auto")):(c=g.data(d,"id"),e&&e.isInProgress()&&e.abort(),e=b("/deal/movieshows/"+c+"/"+k,{method:"GET",on:{success:function(b,c){var d=g.getEvalRes(c),e=d.data;j.hide(),f.append(e),f.setStyle("height","auto"),h.removeClass("current"),a.addClass("current")},failure:function(){}}}))}},".date-label")}},initUserReviews:function(c){function d(){i&&i.on("click",function(a){a.preventDefault();var c,d="/deal/checkfeedback/"+n;o?c=b(d,{method:"POST",on:{success:function(a,b){var c=g.getEvalRes(b),d=c.data;2===c.status?e():1===c.status?window.location.href="/rates/list/torate/"+d.orderid:f(c.msg)},failure:function(){},end:function(){}}}):e()})}function e(){a.use("www-dialog",function(){k?k.open():k=h.Dialog.login({origin:"deal-feedback",galabel:"deal/feedback/login",loginRef:p})})}function f(a){l||(l=new j({id:"check-failure-dialog"})),l.showResult({type:"tip",width:"480px",title:a}),l.open(),l.set("autoHide",3)}var i,k,l,m=a.one("#deal-default .user-reviews"),n=c.dealId,o=c.isLogin,p=c.loginRef;m&&(i=m.one(".to-rate"),a.on("domready",function(){window.location.href.indexOf("#anchor-reviews")>0&&window.scrollTo(0,m.getY()-46),d()}))},initImageSlide:function(b){function c(a){var b,c,f=d(a);f.length&&(a.setData("imgLoadNum",0).setData("imgMaxHeight",0),b=g(a,f),c=e(f.length),a.append(b).append(c),h(a,c,b,f.length))}function d(b){var c=b.getAttribute("data-params"),d=c.split("|"),e=[],g=/^http:\/\/.+\.(jpg|png|gif)(\?v=\d+)?$/i;return a.Array.each(d,function(a){a=f(a.replace(/\n/g,"")),g.test(a)&&e.push(a)}),e}function e(b){var c,d=a.Node.create('<ul class="trigger"></ul>'),e=[];for(c=0;b>c;++c)e.push('<li><a href="javascript:void(0)">'+(c+1)+"</a></li>");return d.setHTML(e.join("")),d.hide(),d}function g(b,c){var d,e=a.Node.create('<ul class="sheet"></ul>'),f=c.length,g=[];for(d=0;f>d;++d)g.push("<li><div><p><img src="+c[d]+" /></p></div></li>");return e.setHTML(g.join("")),e.all("li").hide(),e.one("li").show(),e.all("img").on("load",function(a){var c=a.target.get("height");c>b.getData("imgMaxHeight")&&b.setData("imgMaxHeight",c),b.setData("imgLoadNum",b.getData("imgLoadNum")+1)}),e}function h(c,d,e,f){c.getData("imgLoadNum")===f?(e.setStyle("height",c.getData("imgMaxHeight")+"px"),d.show(),c.setStyle("marginBottom","25px"),a.use("w-tab",function(a){new a.mt.widget.Tab(d.all("li"),e.all("li"),b)})):window.setTimeout(function(){h(c,d,e,f)},500)}var i=a.all(".imageslide");if(i.size()){var j={animStyle:"fade",slideEnabled:!0,slideInterval:5e3};b=b||{},a.mix(b,j),i.each(function(a){c(a)})}},initDealAsync:function(b,c,d,e){var f,g,h=a.one(".J-bottom-list-wrapper"),j=a.one(".J-side-deallist-wrapper"),k=this.AsyncLoader,l=null,m=null,n=M.window;h.setStyle("visibility","hidden"),h.show(),f={action:i.appendTrackingParams("/deal/sidedeallist/"+b),async:null,method:"GET",callback:function(a){var b=a.data;b&&(j.append(b),j.show())}},g={action:"/deal/bottomdeallist/"+b,wrapper:h,method:"GET",async:null,callback:function(b){b.data&&(h.append(b.data),b.trackData&&(b.trackData.url="deal/default"),a.use("mt-log",function(a){a.mt.log.moduleview(b.trackData)}),h.setStyle("visibility","visible"),l.detach(),m.detach())}},e&&k.requestModule(f),d&&(k.winHeight=a.DOM.winHeight(),l=n.resize(function(){k.winHeight=a.DOM.winHeight(),k.asyncLoadWithCheck(g)},12),m=n.scroll(function(){k.asyncLoadWithCheck(g)},12),k.asyncLoadWithCheck(g))},AsyncLoader:{winHeight:0,asyncLoadWithCheck:function(b){var c=a.one(window),d=c.get("docScrollY"),e=b.wrapper.getY();e<=d+2*this.winHeight&&this.requestModule(b)},requestModule:function(a){var c=a.action,d=a.method?a.method:"GET";a.async||(a.async=b(c,{method:d,on:{success:function(b,c){var d=g.getEvalRes(c);a.callback(d)},failure:function(){}}}))}}}},"1.0.0",{requires:["www-base","www-dialog","www-ratelist","www-hub","mt-component","www-tracker","mt-imageloader","www-add-cart","www-sku"]});
M.add("www-deal-detail",function(a){{var b=(a.io,a.DOM,a.UA.ie),c=(a.Lang.isArray,a.Lang.trim,a.mt.util);a.mt.www}a.namespace("mt.www.DealDetail"),a.mt.www.DealDetail={initKtvDetail:function(){var b=a.one(".J-combo-list");if(b){var c=b.one(".J-combo-turn");c&&(b.on("mouseenter",function(){c.show()}),b.on("mouseleave",function(){c.hide()}),this.initTableVScroll(a.one(".J-combo-table-list"),c))}this.bindUnfoldOnClick(".J-combo-detail-wrapper h3",".J-combo-table-detail")},initTableVScroll:function(b,c){function d(a){return k.filter('[data-index="'+a+'"]').item(0)}function e(){var a="switch--disabled";q>1?n.removeClass(a):n.addClass(a),p>=h?o.addClass(a):o.removeClass(a)}function f(){var a=k.filter("[width]");return a.isEmpty()?"":a.item(0).getAttribute("width")}if(b&&c){var g,h,i,j,k,l,m,n,o,p,q=1,r=this;j=b.all("th"),k=j.filter("[data-index]"),m=f(),h=k.size(),l=p=g=k.filter(function(b){return"none"!==a.one(b).getComputedStyle("display")}).size(),c&&(n=c.one(".J-switch-left"),o=c.one(".J-switch-right"),e(),c.delegate("click",function(){this.hasClass("J-switch-left")?q>1&&(i=d(q-1),r.toggleShowCol(b,j.indexOf(i),!0),i=d(p),i.setAttribute("width",m),r.toggleShowCol(b,j.indexOf(i),!1),q--,p--):h>p&&(i=d(q),r.toggleShowCol(b,j.indexOf(i),!1),i=d(p+1),i.setAttribute("width",m),r.toggleShowCol(b,j.indexOf(i),!0),q++,p++),e()},".J-switch-left, .J-switch-right"))}},toggleShowCol:function(a,b,c){var d,e=a.all("tr"),f=0;e.each(function(a){d=a.all(f?"td":"th"),c?d.item(b)&&d.item(b).show():d.item(b)&&d.item(b).hide(),f++})},bindUnfoldOnClick:function(b,c){var d=a.one(".J-combo-table-detail");d&&(d.setStyle("height",d.one("table").getComputedStyle("height")),a.one(".J-deal-content").delegate("click",function(){var a,b=this,d=b.next(c);d&&(parseInt(d.getComputedStyle("height"),10)>0?(d.setStyle("height",0),b.one(".combo-status").addClass("combo-status--down")):(a=d.one("table").getComputedStyle("height"),d.setStyle("height",a),b.one(".combo-status").removeClass("combo-status--down")))},b))},SameBiz:{update:function(d,e){if(e){d.setHTML(e);var f=d.one(".collapse--normal"),g=d.all(".item-list .more"),h="还有"+g.size()+"个";f&&f.on("click",function(){var d=this;if(d.hasClass("collapse--collapsed")?(window.setTimeout(function(){d.setAttribute("gaevent","content/deal/lesssamebiz")},100),d.setHTML('收起<span class="triangle"></span>')):(window.setTimeout(function(){d.setAttribute("gaevent","content/deal/moresamebiz")},100),d.setHTML(h+'<span class="triangle"></span>')),d.toggleClass("collapse--collapsed"),g.toggleClass("hidden"),b&&8>b){var e=a.one(".J-deal-content #deal-other-biz .item-list");c.reflow(e)}})}}}}},"1.0.0",{requires:["www-base"]});